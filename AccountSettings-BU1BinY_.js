import{i as Ve,R as e,_ as pe,f as Se,j as $e,t as je,U as H,V as U,W as G,g as Y,Y as R,af as ve,aM as ae,a6 as I,a9 as O,aD as xe,$ as S,H as $,ax as T,a8 as re,ad as Ce,o as se,bD as He,aX as Ue,a4 as z,bb as Ge,bv as X,c1 as Ye,bK as Xe,aO as ce,bg as Je,bh as Qe,al as be,ag as oe,a0 as J,a1 as k,E as j,b0 as Ze,a2 as ie,b1 as le,a5 as de,r as Q,X as et,aa as Pe,bx as tt,a3 as Te,bE as nt,ca as st,aY as Z,b7 as ge,ae as ke}from"./app-TIsuwqEK.js";import{G as ot,R as at,c as Re,L as _,H as rt,J as Oe,K as ct,l as it,N as Ie,P as Me,O as lt,T as Ae,Q as ut,k as A,U as ue,v as _e,W as De,X as dt,Y as gt,D as me,Z as ee,_ as mt,$ as Ke,a0 as Ne,a1 as qe,a2 as We,a3 as ht,a4 as yt}from"./app-stage2-D0Y65gPS.js";import{A as B,L as Le,a as ft,E as Et}from"./ExportKeyDialog-Cl3IYyaz.js";var wt={root:{position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"}},Be=e.forwardRef(function(n,s){var a=n.classes,o=n.className,r=pe(n,["classes","className"]);return e.createElement("div",Se({className:$e(a.root,o),ref:s},r))});Be.muiName="ListItemSecondaryAction";const pt=Ve(wt,{name:"MuiListItemSecondaryAction"})(Be);var ze=e.forwardRef(function(n,s){var a=n.actions,o=n.children,r=n.name,c=n.value,i=n.onChange,l=pe(n,["actions","children","name","value","onChange"]),h=e.useRef(null),y=e.useRef(c!=null),u=y.current,d=e.useState(function(){return u?null:n.defaultValue}),C=d[0],v=d[1];e.useImperativeHandle(a,function(){return{focus:function(){var x=h.current.querySelector("input:not(:disabled):checked");x||(x=h.current.querySelector("input:not(:disabled)")),x&&x.focus()}}},[]);var E=u?c:C,b=function(x){u||v(x.target.value),i&&i(x,x.target.value)},f={name:r,onChange:b,value:E},g=je(s,h);return e.createElement(ot,Se({role:"radiogroup",ref:g},l),e.createElement(at.Provider,{value:f},o))}),N={},he;function St(){if(he)return N;he=1;var t=H();Object.defineProperty(N,"__esModule",{value:!0}),N.default=void 0;var n=t(U()),s=t(G()),a=(0,s.default)(n.default.createElement("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"RemoveRedEye");return N.default=a,N}var vt=St();const xt=Y(vt);var q={},ye;function Ct(){if(ye)return q;ye=1;var t=H();Object.defineProperty(q,"__esModule",{value:!0}),q.default=void 0;var n=t(U()),s=t(G()),a=(0,s.default)(n.default.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");return q.default=a,q}var bt=Ct();const Fe=Y(bt);var W={},fe;function Pt(){if(fe)return W;fe=1;var t=H();Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var n=t(U()),s=t(G()),a=(0,s.default)(n.default.createElement("path",{d:"M12.65 10C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"}),"VpnKey");return W.default=a,W}var Tt=Pt();const kt=Y(Tt);var w;(t=>{(n=>{n.Custom="Custom",n.OneOutOfN="OneOutOfN",n.MOutOfN="MOutOfN",n.SingleSignature="SingleSignature"})(t.Type||(t.Type={}))})(w||(w={}));function Rt(t){let n;const s=t.signers.map(i=>i.weight),a=Math.max(...s),o=Math.min(...s),r=t.thresholds.low_threshold===t.thresholds.med_threshold&&t.thresholds.med_threshold===t.thresholds.high_threshold,c=Math.max(t.thresholds.low_threshold,t.thresholds.med_threshold,t.thresholds.high_threshold);return t.signers.length<=1?n={type:"SingleSignature"}:o>=c?n={type:"OneOutOfN"}:o===a&&r?n={requiredKeyWeight:Math.ceil(c/o),type:"MOutOfN"}:n={thresholds:t.thresholds,type:"Custom"},{preset:n,signersToAdd:[],signersToRemove:[]}}function Ot(t){if("requiredKeyWeight"in t)return t.requiredKeyWeight;if("thresholds"in t)return Math.max(t.thresholds.low_threshold,t.thresholds.med_threshold,t.thresholds.high_threshold)}function It(t){return t.type==="MOutOfN"||t.type==="Custom"}function Mt(t,n,s){const a=[...s.signersToRemove.map(o=>o.key===t.account_id?I.Operation.setOptions({masterWeight:0}):I.Operation.setOptions({signer:{ed25519PublicKey:o.key,weight:0}})),...s.signersToAdd.map(o=>I.Operation.setOptions({signer:{ed25519PublicKey:o.key,weight:o.weight}}))];return t.data_attr["config.multisig.coordinator"]||a.push(I.Operation.manageData({name:"config.multisig.coordinator",value:n.multiSignatureCoordinator})),s.weightThreshold!==t.thresholds.low_threshold&&s.weightThreshold!==t.thresholds.med_threshold&&s.weightThreshold!==t.thresholds.high_threshold&&a.push(I.Operation.setOptions({lowThreshold:s.weightThreshold,medThreshold:s.weightThreshold,highThreshold:s.weightThreshold})),a}function At(t){const n=R(t.account.accountID,t.account.testnet),s=e.useContext(ve),[a,o]=e.useState(!1),[r,c]=e.useState(),i=e.useMemo(()=>Rt(n),[n]),l=r||i,h=e.useCallback(u=>{c(typeof u=="function"?d=>u(d||i):u)},[c,i]);return{applyUpdate:async u=>{try{o(!0);const d=Mt(n,s,u),C=await Re(d,{accountData:n,horizon:t.horizon,walletAccount:t.account}),v=t.sendTransaction(C);o(!1),await v}catch(d){ae(d),o(!1)}},editorState:l,setEditorState:h,txCreationPending:a}}var M=(t=>(t[t.Presets=0]="Presets",t[t.Signers=1]="Signers",t))(M||{});const D=e.createContext({accountID:"",applyUpdate(){throw Error("MultisigEditorContext has not yet been initialized")},currentStep:0,editorState:{preset:{type:w.Type.SingleSignature},signersToAdd:[],signersToRemove:[]},setEditorState(){throw Error("MultisigEditorContext has not yet been initialized")},switchToStep(){throw Error("MultisigEditorContext has not yet been initialized")},testnet:!1,txCreationPending:!1}),_t=e.memo(function(n){const[s,a]=e.useState(0),r={...At(n),accountID:n.account.accountID,currentStep:s,switchToStep:a,testnet:n.account.testnet};return e.createElement(D.Provider,{value:r},n.children)});var L={},Ee;function Dt(){if(Ee)return L;Ee=1;var t=H();Object.defineProperty(L,"__esModule",{value:!0}),L.default=void 0;var n=t(U()),s=t(G()),a=(0,s.default)(n.default.createElement("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");return L.default=a,L}var Kt=Dt();const Nt=Y(Kt);function qt(t){const n=O(),s=xe(),{t:a}=S();return e.createElement($,{style:t.style},e.createElement(_,null,e.createElement(rt,{style:{fontSize:"2rem"}})),e.createElement(T,null,e.createElement(re,null,e.createElement(Ce,{autoFocus:!0,error:!!t.errors.publicKey,label:t.errors.publicKey?t.errors.publicKey.message:a("account-settings.manage-signers.signers-editor.new-signer.label"),placeholder:a(n?"account-settings.manage-signers.signers-editor.new-signer.placeholder.short":"account-settings.manage-signers.signers-editor.new-signer.placeholder.long"),onChange:o=>t.onUpdate({publicKey:o.target.value.trim()}),style:{flexGrow:1},InputProps:s?{style:{fontSize:"0.8rem"}}:void 0,value:t.values.publicKey}))),e.createElement(_,{style:{marginLeft:8,minWidth:0}},e.createElement(se,{color:"primary",onClick:t.onSubmit,style:{borderColor:He.palette.primary.main,borderStyle:"solid",borderWidth:1.5,padding:8}},e.createElement(Oe,null))),e.createElement(_,{style:{minWidth:0}},e.createElement(se,{onClick:t.onCancel},e.createElement(Ue,null))))}function Wt(t){const{editorState:n,setEditorState:s}=e.useContext(D),{preset:a}=n,o=String(Ot(a)),r=e.useCallback(c=>{c.persist(),s(i=>{const l=Number.parseInt(c.target.value,10);if("requiredKeyWeight"in i.preset)return{...i,preset:{...i.preset,requiredKeyWeight:l}};if("thresholds"in i.preset)return{...i,preset:{...i.preset,thresholds:{high_threshold:l,med_threshold:l,low_threshold:l}}};throw Error(`Cannot update thresholds for multi-sig preset of type "${i.preset.type}"`)})},[s]);return e.createElement(Ce,{inputProps:{min:1,style:{maxWidth:32,padding:"16px 14px",textAlign:"center"}},inputRef:t.inputRef,onChange:r,type:"number",value:o,variant:"outlined"})}const Lt=e.memo(Wt);function Bt(){const{t}=S();return function(s,a){const o={};return!Je(s.publicKey)&&!Qe(s.publicKey)?o.publicKey=new Error(t("account-settings.manage-signers.signers-editor.validation.invalid-stellar-address")):a.find(r=>r.key===s.publicKey)&&(o.publicKey=new Error(t("account-settings.manage-signers.signers-editor.validation.existing-signer"))),s.weight.match(/^[0-9]+$/)||(o.weight=new Error(t("account-settings.manage-signers.signers-editor.validation.integer-required"))),o}}const te={background:"white",boxShadow:"0 8px 12px 0 rgba(0, 0, 0, 0.1)"};function zt(t){const{accounts:n}=e.useContext(z),{editorState:s,setEditorState:a,testnet:o}=e.useContext(D),{lookupFederationRecord:r}=Ge(),c=O(),i=Bt(),l=e.createRef(),{t:h}=S(),{preset:y}=s,[u,d]=e.useState(!1),[C,v]=e.useState({}),[E,b]=e.useState({publicKey:"",weight:"1"}),f=e.useCallback(()=>d(!0),[d]),g=m=>a(p=>({...p,signersToAdd:[...p.signersToAdd,m]})),P=m=>{var p;a(K=>({...K,signersToAdd:K.signersToAdd.filter(V=>V.key!==m.key),signersToRemove:[...K.signersToRemove,m]})),(p=l.current)==null||p.focus()},x=async()=>{var m;try{const p=E.publicKey.indexOf("*")>-1?await r(E.publicKey):null,K=p?p.account_id:E.publicKey,V=i(E,t.signers);if(Object.keys(V).length>0)return v(V);g({key:K,type:"ed25519_public_key",weight:parseInt(E.weight,10)}),d(!1),v({}),b({publicKey:"",weight:"1"}),(m=l.current)==null||m.focus()}catch(p){ae(p)}},F=m=>{b(p=>({...p,...m}))};return e.createElement(X,{disablePadding:c},u?e.createElement(qt,{errors:C,onCancel:()=>d(!1),onSubmit:x,onUpdate:F,style:te,values:E}):e.createElement(Ye,{gutterBottom:!0,onClick:f},e.createElement(Xe,null),"  ",h("account-settings.manage-signers.action.add-signer")),t.signers.map(m=>e.createElement($,{key:m.key,style:te},e.createElement(_,null,e.createElement(Nt,{style:{fontSize:"2rem"}})),e.createElement(T,{primary:e.createElement(ce,{address:m.key,testnet:t.testnet,variant:"full"}),secondary:e.createElement(e.Fragment,null,t.showKeyWeights?e.createElement("span",{style:{marginRight:24}},h("account-settings.manage-signers.signers-editor.list.item.weight"),": ",m.weight):null,n.some(p=>p.publicKey===m.key&&p.testnet===o)?e.createElement("span",null,h("account-settings.manage-signers.signers-editor.list.item.local-key")):null)}),e.createElement(pt,null,e.createElement(se,{"aria-label":"Remove",disabled:t.signers.length===1,onClick:()=>P(m)},e.createElement(ct,null))))),It(y)?e.createElement(e.Fragment,null,e.createElement($,{style:te},e.createElement(_,null,e.createElement("div",null)),e.createElement(T,{primary:h("account-settings.manage-signers.signers-editor.threshold.primary"),secondary:h("account-settings.manage-signers.signers-editor.threshold.secondary"),style:{flexGrow:0,marginRight:32}}),e.createElement(T,null,e.createElement(Lt,{inputRef:l}))),e.createElement(it,null)):null)}function Ft(t){var s;const{t:n}=S();return e.createElement(ze,{value:((s=t.selected)==null?void 0:s.key)||""},e.createElement(X,null,t.signers.map(a=>e.createElement($,{button:!0,key:a.key,onClick:()=>t.onSelect(a)},e.createElement(_,null,e.createElement(Ie,{edge:"start",value:a.key})),e.createElement(T,{primary:e.createElement(ce,{address:a.key,variant:"full",testnet:t.testnet}),secondary:t.accounts.some(o=>o.publicKey===a.key&&o.testnet===t.testnet)?e.createElement("span",null,n("account-settings.manage-signers.signers-editor.list.item.local-key")):null})))))}const Vt=e.memo(Ft),$t=e.memo(function(n){const{t:s}=S();let a="",o="";return n.preset.type===w.Type.SingleSignature?a=s("account-settings.manage-signers.preset-description.single-signature"):n.preset.type===w.Type.OneOutOfN?a=s("account-settings.manage-signers.preset-description.one-out-of-n"):n.preset.type===w.Type.MOutOfN&&(a=s("account-settings.manage-signers.preset-description.m-out-of-n",{count:n.preset.requiredKeyWeight||0})),n.preset.type===w.Type.SingleSignature||(n.preset.type===w.Type.OneOutOfN?o=s("account-settings.manage-signers.preset-description-extra.one-out-of-n"):n.preset.type===w.Type.MOutOfN&&(o=s("account-settings.manage-signers.preset-description-extra.m-out-of-n"))),e.createElement(e.Fragment,null,e.createElement(j,{align:"center",color:"textSecondary",gutterBottom:!0},a),o?e.createElement(j,{align:"center",color:"textSecondary"},o):null)});function jt(t){var v;const[n,s]=e.useState(),{t:a}=S(),{accounts:o}=e.useContext(z),{accountID:r,editorState:c,setEditorState:i,testnet:l}=e.useContext(D),h=R(r,l),y=O(),u=c.preset.type===w.Type.SingleSignature&&h.signers.length>1,d=e.useCallback(E=>{s(E),i(b=>({...b,signersToAdd:[],signersToRemove:h.signers.filter(f=>f.key!==E.key)}))},[h,i]),C=t.disabled||u&&!n;return e.createElement(be,null,u?e.createElement(Vt,{accounts:o,onSelect:d,selected:n,signers:h.signers,testnet:l}):e.createElement(zt,{...t}),e.createElement(oe,{margin:"32px 0 0"},e.createElement($t,{preset:c.preset})),e.createElement(Me,{target:(v=t.actionsRef)==null?void 0:v.element},e.createElement(J,{desktopStyle:{margin:0}},e.createElement(k,{disabled:C,icon:e.createElement(Oe,null),onClick:t.onSubmit,type:"submit"},a(y?"account-settings.manage-signers.action.apply.short":"account-settings.manage-signers.action.apply.long")))))}const Ht=e.memo(jt),ne=e.memo(function(n){return e.createElement(B,{icon:e.createElement(Ie,{checked:n.selected,color:"primary",onChange:n.onChange}),onClick:n.onChange},e.createElement(T,{primary:n.primary,secondary:n.secondary}))});function Ut(t){var y;const{accountID:n,editorState:s,setEditorState:a,testnet:o}=e.useContext(D),{t:r}=S(),c=R(n,o),i=Math.min(...c.signers.map(u=>u.weight)),l=s.preset.type!==w.Type.SingleSignature||c.signers.length>1,h=u=>a(d=>({...d,preset:u}));return e.createElement(be,null,e.createElement(j,{gutterBottom:!0,style:{marginLeft:8,marginRight:8},variant:"h6"},r("account-settings.manage-signers.preset-selector.title")),e.createElement(ze,null,e.createElement(X,{style:t.style},e.createElement(ne,{onChange:()=>h({type:w.Type.SingleSignature}),primary:r("account-settings.manage-signers.preset-selector.options.single-signature.primary"),selected:s.preset.type===w.Type.SingleSignature,secondary:r("account-settings.manage-signers.preset-selector.options.single-signature.secondary")}),e.createElement(ne,{onChange:()=>h({requiredKeyWeight:c.thresholds.high_threshold||i,type:w.Type.MOutOfN}),primary:r("account-settings.manage-signers.preset-selector.options.m-out-of-n.primary"),selected:s.preset.type===w.Type.MOutOfN,secondary:r("account-settings.manage-signers.preset-selector.options.m-out-of-n.secondary")}),e.createElement(ne,{onChange:()=>h({type:w.Type.OneOutOfN}),primary:r("account-settings.manage-signers.preset-selector.options.one-out-of-n.primary"),selected:s.preset.type===w.Type.OneOutOfN,secondary:r("account-settings.manage-signers.preset-selector.options.one-out-of-n.secondary")}))),e.createElement(Me,{target:(y=t.actionsRef)==null?void 0:y.element},e.createElement(J,{desktopStyle:{margin:0}},e.createElement(k,{disabled:!l,icon:e.createElement(lt,null),onClick:t.onProceed,type:"submit"},r("account-settings.manage-signers.action.proceed")))))}const Gt=e.memo(Ut);function Yt(t,n,s){const a=n.map(l=>l.key),o=s.map(l=>l.key),r=l=>a.indexOf(l.key)===-1,c=l=>o.indexOf(l.key)===-1,i=[...t.signers.filter(r).filter(c),...n];return[...i.filter(l=>l.key!==t.id).reverse(),...i.filter(l=>l.key===t.id)]}function Xt(t,n){return t.type===w.Type.SingleSignature?0:t.type===w.Type.OneOutOfN?Math.min(...n.map(s=>s.weight)):t.type===w.Type.MOutOfN?t.requiredKeyWeight:t.thresholds.high_threshold}function Jt(t,n){const s=t.reduce((a,o)=>a+o.weight,0);if(n<0||n<1&&t.length>1)throw de("MultiSigConfigThresholdTooLowError","Signature threshold too low.");if(n>s)throw de("MultiSigConfigThresholdLockError","Signature threshold too high. You would lock your account.")}function Qt(t){const{accountID:n,applyUpdate:s,currentStep:a,editorState:o,setEditorState:r,switchToStep:c,testnet:i}=e.useContext(D),l=R(n,i),h=Ze(),y=ie(),u=e.useRef(o),d=Yt(l,o.signersToAdd,o.signersToRemove),C=d.every(g=>g.weight===1),v=e.useCallback(()=>{y.history.push(ut(t.account.id)),c(M.Signers)},[t.account.id,y.history,c]),E=e.useCallback(()=>{r(g=>({...g,signersToRemove:[],signersToAdd:[]})),c(M.Presets)},[c,r]);e.useEffect(()=>{A(y.location.pathname,ue(t.account.id),!0)&&E()},[y.location.pathname,t.account.id,E]);const b=async()=>{try{const g=Xt(o.preset,d);Jt(d,g),await s({signersToAdd:o.signersToAdd,signersToRemove:o.signersToRemove,weightThreshold:g}),u.current=o,r(P=>({...P,signersToAdd:[],signersToRemove:[]}))}catch(g){ae(g)}},f=e.useMemo(()=>{const g=u.current,P=o.preset.type==="Custom"&&g.preset.type==="Custom"?o.preset.thresholds.high_threshold===g.preset.thresholds.high_threshold&&o.preset.thresholds.med_threshold===g.preset.thresholds.med_threshold&&o.preset.thresholds.low_threshold===g.preset.thresholds.low_threshold:o.preset.type==="MOutOfN"&&g.preset.type==="MOutOfN"?o.preset.requiredKeyWeight===g.preset.requiredKeyWeight:o.preset.type===g.preset.type;return(o.preset.type==="Custom"||o.preset.type==="MOutOfN")&&l.signers.length+o.signersToAdd.length<2?!0:o.signersToAdd.length===0&&o.signersToRemove.length===0&&P},[l,o]);return e.createElement(le,{actions:h},e.createElement(_e,{current:a===M.Signers?1:0},e.createElement(Gt,{actionsRef:a===M.Presets?h:void 0,onProceed:v,style:{marginBottom:24}}),e.createElement(Ht,{actionsRef:a===M.Signers?h:void 0,disabled:f,onSubmit:b,signers:d,showKeyWeights:!C,testnet:i})))}function Zt(t){return e.createElement(Ae,{account:t.account},({horizon:n,sendTransaction:s})=>e.createElement(_t,{account:t.account,horizon:n,sendTransaction:s},e.createElement(Qt,{account:t.account,onCancel:t.onClose})))}const en=e.memo(Zt);function tn(t){return Q.createElement(et,{transform:"rotate(90)",viewBox:"0 0 24 20",...t},Q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},Q.createElement("path",{d:"M17 20.41L18.41 19 15 15.59 13.59 17 17 20.41zM7.5 8H11v5.59L5.59 19 7 20.41l6-6V8h3.5L12 3.5 7.5 8z"})))}const nn={color:"red"},sn=e.memo(function(n){const{t:s}=S();return e.createElement(Te,{cancelButton:e.createElement(k,{onClick:n.onCancel},s("account-settings.account-deletion.action.cancel")),confirmButton:e.createElement(k,{onClick:n.onConfirm,type:"primary"},s("account-settings.account-deletion.action.confirm")),open:n.open,onClose:n.onClose,title:s("account-settings.account-deletion.confirm.title")},s("account-settings.account-deletion.confirm.text.delete"),n.merging?` ${s("account-settings.account-deletion.confirm.text.merge")}. `:". ",s("account-settings.account-deletion.confirm.text.confirm"))}),on=e.memo(function(n){const{t:s}=S();return e.createElement(Te,{cancelButton:null,confirmButton:e.createElement(k,{onClick:n.onClose,type:"primary"},s("account-settings.account-deletion.warning-dialog.close.label")),onClose:n.onClose,open:n.open,title:n.title},n.warning)});function an(t){const n=R(t.account.accountID,t.account.testnet),s=t.horizon,{accounts:a}=e.useContext(z),[o,r]=e.useState(!1),[c,i]=e.useState(!1),[l,h]=e.useState(null),[y,u]=e.useState(),{t:d}=S(),C=O(),v=xe(),E=e.useCallback(()=>i(!1),[i]),b=e.useCallback(()=>r(m=>!m),[]),f=e.useCallback(()=>{u(m=>m?{...m,open:!1}:void 0)},[u]),g=async()=>{if(l){const m=await Re([I.Operation.accountMerge({source:t.account.accountID,destination:l.publicKey,withMuxing:!0})],{accountData:n,horizon:s,walletAccount:t.account});await t.sendTransaction(m)}},P=()=>{i(!1),o?g():t.onDelete()},x=e.useCallback(()=>{o&&n.subentry_count>0?u({open:!0,text:d("account-settings.account-deletion.warnings.cannot-merge.text"),title:d("account-settings.account-deletion.warnings.cannot-merge.title")}):i(!0)},[n,o,i,u,d]),F=e.useMemo(()=>n.balances.length>0?e.createElement(e.Fragment,null,e.createElement(re,{alignItems:"center",style:{marginTop:24,marginLeft:-12,marginBottom:8}},e.createElement(De,{color:"primary",checked:o,onChange:b}),e.createElement(j,{onClick:b,variant:"h6",style:{display:"flex",alignItems:"center",height:48,cursor:"pointer",fontSize:C?16:20,marginLeft:8}},d("account-settings.account-deletion.remaining-funds.text"))),e.createElement(dt,{disabled:!o,accounts:a.filter(m=>m.accountID!==t.account.accountID&&m.publicKey!==t.account.publicKey&&m.testnet===t.account.testnet),testnet:t.account.testnet,onChange:h})):null,[n.balances.length,o,b,C,d,a,t.account.accountID,t.account.publicKey,t.account.testnet]);return e.createElement(le,{background:e.createElement(gt,{style:{fontSize:160}}),noMaxWidth:!0,preventNotchSpacing:!0,top:e.createElement(Pe,{hideBackButton:!0,title:e.createElement("span",{style:nn},d("account-settings.account-deletion.title")),titleColor:"inherit",onBack:t.onClose,style:{marginTop:0,marginLeft:0}}),actions:e.createElement(J,null,o?e.createElement(k,{autoFocus:!0,disabled:!l,icon:e.createElement(tn,null),onClick:x,type:"primary"},d(v?"account-settings.account-deletion.action.merge.short":"account-settings.account-deletion.action.merge.long")):e.createElement(k,{autoFocus:!0,icon:e.createElement(Fe,null),onClick:x,type:"primary"},d("account-settings.account-deletion.action.delete")))},e.createElement(tt,{style:{padding:0}},e.createElement(me,{style:{marginTop:8}},d("account-settings.account-deletion.text.1",{accountName:t.account.name})),e.createElement(me,{style:{display:n.balances.length>0?void 0:"none",marginTop:16}},d("account-settings.account-deletion.text.2")),F,e.createElement(sn,{merging:o,onCancel:E,onClose:E,onConfirm:P,open:c}),e.createElement(on,{onClose:f,open:!!(y!=null&&y.open),title:(y==null?void 0:y.title)||"",warning:y==null?void 0:y.text})))}function rn(t){const{deleteAccount:n}=e.useContext(z),s=()=>{n(t.account.id),t.onClose(),t.onDeleted()};return e.createElement(Ae,{account:t.account,onSubmissionCompleted:s},a=>e.createElement(an,{...t,...a,onDelete:s}))}const we=e.createElement(ke,{position:"start"},e.createElement(Le,{color:"disabled"})),cn=e.createElement(ke,{position:"start"},e.createElement(ft,{color:"disabled"}));function ln(){const{t}=S();return function(s,a){const o={};!s.prevPassword&&a!=="initial"&&(o.prevPassword=new Error(t("account-settings.set-password.validation.previous-password-missing"))),a!=="remove"&&(s.nextPassword||(o.nextPassword=new Error(t("account-settings.set-password.validation.next-password-missing"))),s.nextPasswordRepeat||(o.nextPasswordRepeat=new Error(t("account-settings.set-password.validation.next-password-repeat-missing"))),s.nextPasswordRepeat&&s.nextPassword!==s.nextPasswordRepeat&&(o.nextPasswordRepeat=new Error(t("account-settings.set-password.validation.passwords-no-match"))));const r=Object.keys(o).length===0;return{errors:o,success:r}}}function un(t){const n=O(),{t:s}=S();return e.createElement(J,{smallDialog:!0},t.isPasswordProtected?n?e.createElement(k,{onClick:t.onToggleRemovePassword,type:"secondary"},t.removePassword?s("account-settings.set-password.action.change-password.long"):s("account-settings.set-password.action.remove-password.long")):e.createElement(mt,{control:e.createElement(De,{checked:t.removePassword,color:"primary",onChange:t.onToggleRemovePassword}),label:s("account-settings.set-password.action.remove-password.long")}):null,e.createElement(k,{icon:e.createElement(Le,null),onClick:t.onSubmit,type:"primary"},n?t.removePassword?s("account-settings.set-password.action.remove-password.long"):s("account-settings.set-password.action.change-password.short"):t.removePassword?s("account-settings.set-password.action.remove-password.long"):s("account-settings.set-password.action.change-password.long")))}function dn(t){const n=e.useContext(z),{showError:s,showNotification:a}=e.useContext(nt),[o,r]=e.useState({}),[c,i]=e.useState({nextPassword:"",nextPasswordRepeat:"",prevPassword:""}),[l,h]=e.useState(!1),y=ln(),{t:u}=S(),d=()=>{const{id:f,requiresPassword:g}=t.account,{nextPassword:P,prevPassword:x}=c,m=y(c,g?"change":"initial");r(m.errors),m.success&&n.changePassword(f,x,P).then(()=>{a("success",u(g?"account-settings.set-password.notification.password-changed":"account-settings.set-password.notification.password-set")),t.onClose()}).catch(p=>{ge(p)?r({prevPassword:p}):s(p)})},C=()=>{t.onClose(),i({nextPassword:"",nextPasswordRepeat:"",prevPassword:""})},v=()=>{const f=y(c,"remove");r(f.errors),f.success&&n.removePassword(t.account.id,c.prevPassword).then(()=>{a("success",u("account-settings.set-password.notification.password-removed")),t.onClose()}).catch(g=>{ge(g)?r({prevPassword:g}):s(g)})},E=(f,g)=>{i({...c,[f]:g})},b=()=>h(!l);return e.createElement(le,{noMaxWidth:!0,preventNotchSpacing:!0,top:e.createElement(Pe,{hideBackButton:!0,onBack:C,title:t.account.requiresPassword?u("account-settings.set-password.title.change-password"):u("account-settings.set-password.title.set-password")}),actions:e.createElement(st,{style:{margin:"32px 0 0"}},e.createElement(un,{isPasswordProtected:t.account.requiresPassword,onSubmit:l?v:d,onToggleRemovePassword:b,removePassword:l}))},e.createElement(re,{alignSelf:"center",justifyContent:"space-evenly",margin:"24px 0 0",width:"calc(100% + 16px)",wrap:"wrap"},e.createElement(oe,{basis:"400px",grow:0,hidden:!t.account.requiresPassword,margin:"0 16px",shrink:!0},e.createElement(ee,{autoFocus:t.account.requiresPassword&&!0,error:!!o.prevPassword,label:o.prevPassword?Z(o.prevPassword,u):u("account-settings.set-password.textfield.prev-password.label"),fullWidth:!0,margin:"normal",value:c.prevPassword,onChange:f=>E("prevPassword",f.target.value),InputProps:{startAdornment:cn}})),e.createElement(oe,{basis:"400px",grow:0,hidden:l,margin:"0 16px",shrink:!0},e.createElement(ee,{autoFocus:!t.account.requiresPassword&&!0,error:!!o.nextPassword,label:o.nextPassword?Z(o.nextPassword,u):u("account-settings.set-password.textfield.next-password.label"),fullWidth:!0,margin:"normal",value:c.nextPassword,onChange:f=>E("nextPassword",f.target.value),InputProps:{startAdornment:we}}),e.createElement(ee,{error:!!o.nextPasswordRepeat,label:o.nextPasswordRepeat?Z(o.nextPasswordRepeat,u):u("account-settings.set-password.textfield.next-password-repeat.label"),fullWidth:!0,margin:"normal",value:c.nextPasswordRepeat,onChange:f=>E("nextPasswordRepeat",f.target.value),InputProps:{startAdornment:we}}))))}const gn=e.memo(dn);function mn(t){const n=ie(),s=A(n.location.pathname,qe("*")),a=A(n.location.pathname,Ne("*")),o=A(n.location.pathname,Ke("*")),r=A(n.location.pathname,ue("*")),c=e.useMemo(()=>({accountSettings:()=>n.history.push(We(t.account.id)),allAccounts:()=>n.history.push(yt())}),[n.history,t.account]);return e.createElement(e.Fragment,null,e.createElement("div",{style:{display:s?void 0:"none",height:"100%"}},e.createElement(gn,{account:t.account,onClose:c.accountSettings})),e.createElement("div",{style:{display:a?void 0:"none",height:"100%"}},e.createElement(rn,{account:t.account,onClose:c.accountSettings,onDeleted:c.allAccounts})),e.createElement("div",{style:{display:o?void 0:"none",height:"100%"}},e.createElement(Et,{account:t.account,onClose:c.accountSettings,variant:"export"})),e.createElement("div",{style:{display:r?void 0:"none",height:"100%"}},e.createElement(en,{account:t.account,onClose:c.accountSettings})))}function hn(t){const n=R(t.account.accountID,t.account.testnet),s=O(),{t:a}=S(),o=!n.balances.length||!n.signers.some(c=>c.key===t.account.publicKey),r=t.account.cosignerOf?e.createElement(e.Fragment,null,a("account-settings.settings.multi-sig.text.secondary.cosigner-of")," ",e.createElement(ce,{address:t.account.cosignerOf,testnet:t.account.testnet})):a(s?"account-settings.settings.multi-sig.text.secondary.short":"account-settings.settings.multi-sig.text.secondary.long");return e.createElement(B,{caret:"right",disabled:o,icon:e.createElement(ht,{style:{fontSize:"100%"}}),onClick:t.onClick},e.createElement(T,{primary:a("account-settings.settings.multi-sig.text.primary"),secondary:r,style:t.listItemTextStyle}))}function yn(t){R(t.account.publicKey,t.account.testnet);const{t:n}=S();return e.createElement(B,{caret:"right",icon:e.createElement(Fe,{style:{fontSize:"100%"}}),onClick:t.onClick},e.createElement(T,{primary:n("account-settings.settings.delete-account.text.primary"),style:t.listItemTextStyle}))}function fn(t){const n=O(),s=ie(),{t:a}=S(),o=e.useContext(ve),r=e.useMemo(()=>({changePassword:()=>s.history.push(qe(t.account.id)),deleteAccount:()=>s.history.push(Ne(t.account.id)),exportSecretKey:()=>s.history.push(Ke(t.account.id)),manageSigners:()=>s.history.push(ue(t.account.id))}),[s.history,t.account]),c=A(s.location.pathname,We(t.account.id),!0),i=e.useMemo(()=>({paddingRight:n?0:void 0}),[n]);return e.createElement(_e,{current:c?0:1},e.createElement(X,{style:{padding:n?0:"24px 16px"}},e.createElement(B,{caret:"right",icon:e.createElement(kt,{style:{fontSize:"100%"}}),onClick:r.changePassword},e.createElement(T,{primary:t.account.requiresPassword?a("account-settings.settings.set-password.text.primary.account-protected"):a("account-settings.settings.set-password.text.primary.account-not-protected"),secondary:t.account.requiresPassword?a("account-settings.settings.set-password.text.secondary.account-protected"):a("account-settings.settings.set-password.text.secondary.account-not-protected"),style:i})),o.multiSignature?e.createElement(e.Suspense,{fallback:null},e.createElement(hn,{...t,listItemTextStyle:i,onClick:r.manageSigners})):null,e.createElement(B,{caret:"right",icon:e.createElement(xt,{style:{fontSize:"100%"}}),onClick:r.exportSecretKey},e.createElement(T,{primary:a("account-settings.settings.export-secret-key.text.primary"),secondary:a("account-settings.settings.export-secret-key.text.secondary"),style:i})),e.createElement(e.Suspense,{fallback:null},e.createElement(yn,{...t,listItemTextStyle:i,onClick:r.deleteAccount}))),e.createElement(mn,{account:t.account}))}const Sn=e.memo(fn);export{Sn as default};
//# sourceMappingURL=AccountSettings-BU1BinY_.js.map
