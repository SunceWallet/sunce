{"version":3,"file":"LumenPurchaseOptions-D9_AU5FC.js","sources":["../src/LumenPurchase/components/LegalConfirmation.tsx","../src/LumenPurchase/components/LumenPurchaseOptions.tsx"],"sourcesContent":["import React from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport Fade from \"@material-ui/core/Fade\"\nimport Typography from \"@material-ui/core/Typography\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport { useDialogActions, useIsMobile } from \"~Generic/hooks/userinterface\"\nimport { breakpoints, CompactDialogTransition } from \"~App/theme\"\nimport DialogBody from \"~Layout/components/DialogBody\"\nimport { ActionButton, DialogActionsBox } from \"~Generic/components/DialogActions\"\nimport Portal from \"~Generic/components/Portal\"\n\nconst useLegalConfirmationStyles = makeStyles({\n  root: {\n    [breakpoints.down(600)]: {\n      zIndex: 1400\n    }\n  },\n  dialogPaper: {\n    [breakpoints.down(600)]: {\n      alignSelf: \"flex-end\",\n      background: \"rgba(255, 255, 255, 0.9)\",\n      margin: \"0 20px 120px\"\n    }\n  }\n})\n\ninterface Props {\n  message: React.ReactNode\n  onClose: () => void\n  onConfirm: () => void\n  open: boolean\n}\n\nfunction LegalConfirmation(props: Props) {\n  const classes = useLegalConfirmationStyles()\n  const dialogActionsRef = useDialogActions()\n  const isSmallScreen = useIsMobile()\n  const { t } = useTranslation()\n\n  const actions = React.useMemo(\n    () => (\n      <DialogActionsBox className={classes.root} smallDialog transparent>\n        <Fade enter={isSmallScreen} exit={isSmallScreen} in={props.open}>\n          <ActionButton onClick={props.onConfirm} type=\"primary\">\n            {t(\"account.purchase-lumens.legal-confirmation.action.confirm\")}\n          </ActionButton>\n        </Fade>\n      </DialogActionsBox>\n    ),\n    [classes.root, isSmallScreen, props.onConfirm, props.open, t]\n  )\n\n  return (\n    <Dialog\n      classes={{\n        paper: classes.dialogPaper\n      }}\n      onClose={props.onClose}\n      open={props.open}\n      TransitionComponent={CompactDialogTransition}\n    >\n      <DialogBody actions={dialogActionsRef} preventActionsPlaceholder preventNotchSpacing>\n        <Typography color=\"textSecondary\">{props.message}</Typography>\n      </DialogBody>\n      <Portal target={isSmallScreen ? document.body : dialogActionsRef.element}>{actions}</Portal>\n    </Dialog>\n  )\n}\n\nexport default React.memo(LegalConfirmation)\n","import React from \"react\"\nimport { Trans, useTranslation } from \"react-i18next\"\nimport List from \"@material-ui/core/List\"\nimport ListItem from \"@material-ui/core/ListItem\"\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\"\nimport ListItemText from \"@material-ui/core/ListItemText\"\nimport OpenInNewIcon from \"@material-ui/icons/OpenInNew\"\nimport { Account } from \"~App/contexts/accounts\"\nimport { trackError } from \"~App/contexts/notifications\"\nimport { CustomError } from \"~Generic/lib/errors\"\nimport { openLink } from \"~Platform/links\"\nimport LegalConfirmation from \"./LegalConfirmation\"\n\n// Fetch a signed URL for redirecting to MoonPay with a walletaddress\nasync function fetchSignedMoonpayURL(account: Account) {\n  const baseURL = \"https://ncy9jaxgqh.execute-api.eu-central-1.amazonaws.com/moonpay\"\n  const url = `${baseURL}?walletAddress=${account.accountID}&testnet=${account.testnet}`\n\n  const response = await fetch(url)\n\n  if (!response.ok) {\n    const responseText = await response.text()\n    throw CustomError(\"HttpRequestError\", `HTTP fetch failed: ${responseText} \\nService: ${url}`, {\n      response: responseText,\n      service: url\n    })\n  }\n\n  const result = await response.json()\n  return result.url\n}\n\ninterface LumenDepositOptionsProps {\n  account: Account\n  onCloseDialog: () => void\n}\n\nfunction LumenDepositOptions(props: LumenDepositOptionsProps) {\n  const { account, onCloseDialog } = props\n  const [isLegalNoteOpen, setIsLegalNoteOpen] = React.useState(false)\n  const { t } = useTranslation()\n\n  const closeLegalNote = React.useCallback(() => setIsLegalNoteOpen(false), [])\n  const openLegalNote = React.useCallback(() => setIsLegalNoteOpen(true), [])\n\n  const navigateToMoonPay = React.useCallback(async () => {\n    try {\n      const signedMoonpayURL = await fetchSignedMoonpayURL(account)\n      openLink(signedMoonpayURL)\n      onCloseDialog()\n    } catch (error) {\n      trackError(error)\n    }\n  }, [account, onCloseDialog])\n\n  return (\n    <List style={{ margin: \"16px auto\", maxWidth: 600 }}>\n      <ListItem button onClick={openLegalNote}>\n        <ListItemText\n          primary={t(\"account.purchase-lumens.moonpay.text.primary\")}\n          secondary={t(\"account.purchase-lumens.moonpay.text.secondary\")}\n        />\n        <ListItemIcon style={{ minWidth: 24, marginLeft: 12 }}>\n          <OpenInNewIcon />\n        </ListItemIcon>\n      </ListItem>\n      <LegalConfirmation\n        message={\n          <Trans i18nKey=\"account.purchase-lumens.moonpay.legal-confirmation\">\n            You will be redirected to moonpay.io, a third-party service. The depositing process is operated by Moon Pay\n            Ltd, not by Sunce or Montelibero.\n            <br />\n            <br />\n            Please contact the moonpay.io support for inquiries related to your deposit.\n          </Trans>\n        }\n        onClose={closeLegalNote}\n        open={isLegalNoteOpen}\n        onConfirm={navigateToMoonPay}\n      />\n    </List>\n  )\n}\n\nexport default React.memo(LumenDepositOptions)\n"],"names":["useLegalConfirmationStyles","makeStyles","breakpoints","LegalConfirmation","props","classes","dialogActionsRef","useDialogActions","isSmallScreen","useIsMobile","t","useTranslation","actions","React","DialogActionsBox","Fade","ActionButton","Dialog","CompactDialogTransition","DialogBody","Typography","Portal","LegalConfirmation$1","fetchSignedMoonpayURL","account","url","response","responseText","CustomError","LumenDepositOptions","onCloseDialog","isLegalNoteOpen","setIsLegalNoteOpen","closeLegalNote","openLegalNote","navigateToMoonPay","signedMoonpayURL","openLink","error","trackError","List","ListItem","ListItemText","ListItemIcon","OpenInNewIcon","Trans","LumenDepositOptions$1"],"mappings":"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"}