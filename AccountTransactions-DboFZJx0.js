import{U as _,V as E,W as q,g as T,R as t,cc as ue,cd as me,$ as h,am as de,ce as ye,aM as fe,Z as X,a9 as P,a2 as M,bv as ee,bx as D,ai as te,af as A,H as ne,ax as d,a1 as ge,ap as f,bM as he,a6 as ve,bw as g,az as K,cf as ae,aE as be,Y as Ee,bP as Te,c8 as Se,al as pe,bL as Ce}from"./app-CqnB7y_E.js";import{p as F,aa as R,b as xe,ab as H,ac as we,v as Re,ad as _e,L as qe,ae as Me,af as Ie,ag as Ke,e as Pe,w as y,ah as Le,T as Oe,Y as ke,t as Ae,ai as De,aj as Fe,ak as He}from"./app-stage2-Hk4VswmV.js";import{M as re}from"./MainSelectionButton-DOFn0YGu.js";import{r as Be}from"./util-CPlYhdQz.js";import{R as ze}from"./Remove-Dz3X15o1.js";import{S as U}from"./SwapHoriz-oODHXstL.js";var S={},$;function Ue(){if($)return S;$=1;var n=_();Object.defineProperty(S,"__esModule",{value:!0}),S.default=void 0;var e=n(E()),a=n(q()),c=(0,a.default)(e.default.createElement("path",{d:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"}),"DoneAll");return S.default=c,S}var $e=Ue();const je=T($e);var p={},j;function Ne(){if(j)return p;j=1;var n=_();Object.defineProperty(p,"__esModule",{value:!0}),p.default=void 0;var e=n(E()),a=n(q()),c=(0,a.default)(e.default.createElement("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"}),"CreditCard");return p.default=c,p}var Ve=Ne();const We=T(Ve);function Ye(n,e,a){const[c,s]=t.useState(Date.now()),o=15,{transactions:i,olderTransactionsAvailable:r}=ue(n,e,c),u=me(n,e),l=t.useMemo(()=>a(i),[i]),m=async(v=0)=>{if(v>=o){s(Date.now());return}const L=await u(),I=a(L);return m(v+I.length)};return t.useEffect(()=>{l.length<o&&m(l.length)},[l]),{olderTransactionsAvailable:r,transactions:l,fetchMoreTransactions:m}}var C={},N;function Ze(){if(N)return C;N=1;var n=_();Object.defineProperty(C,"__esModule",{value:!0}),C.default=void 0;var e=n(E()),a=n(q()),c=(0,a.default)(e.default.createElement("path",{d:"M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"}),"ThumbUp");return C.default=c,C}var Ge=Ze();const Je=T(Ge);function Qe(n){const[e,a]=t.useState(!1),{t:c}=h(),s=async()=>{try{a(!0),await ye(n.horizonURL,n.publicKey)}catch(o){a(!1),fe(o)}};return t.createElement(re,{Icon:e?de:Je,className:n.className,description:c("account.transactions.action.friendbot.description"),label:c("account.transactions.action.friendbot.label"),onClick:s,style:n.style})}var b={},O,V;function Xe(){if(V)return O;V=1;var n=Be();O=e;function e(a){a instanceof Date&&(a=Math.round((Date.now()-a)/1e3));var c=a<0?"from now":"ago";a=Math.abs(a);for(var s=[a/60/60/24/365,a/60/60/24/30,a/60/60/24/7,a/60/60/24,a/60/60,a/60,a],o=["year","month","week","day","hour","minute","second"],i=0;i<o.length;i++){var r=Math.floor(s[i]);if(r>1)return n.format("%d %ss %s",r,o[i],c);if(r===1)return n.format("%d %s %s",r,o[i],c)}return n.format("0 seconds %s",c)}return O}var W;function et(){if(W)return b;W=1;var n=b&&b.__extends||function(){var s=function(o,i){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,u){r.__proto__=u}||function(r,u){for(var l in u)u.hasOwnProperty(l)&&(r[l]=u[l])},s(o,i)};return function(o,i){s(o,i);function r(){this.constructor=o}o.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(b,"__esModule",{value:!0});var e=E(),a=Xe(),c=function(s){n(o,s);function o(i){var r=s.call(this,i)||this;return r.state=r.getStateFromProps(i),r}return o.prototype.getStateFromProps=function(i){return{formattedTime:a(new Date(i.time)).replace(/minute/,"min").replace(/^.*second.*$/,"now")}},o.prototype.componentDidMount=function(){var i=this;this._timer=setInterval(function(){return i.setState(i.getStateFromProps(i.props))},this.props.period||3e4)},o.prototype.componentWillUnmount=function(){clearInterval(this._timer)},o.prototype.render=function(){return this.state.formattedTime},o}(e.Component);return b.default=c,b}var tt=et();const nt=T(tt);var x={},Y;function at(){if(Y)return x;Y=1;var n=_();Object.defineProperty(x,"__esModule",{value:!0}),x.default=void 0;var e=n(E()),a=n(q()),c=(0,a.default)(e.default.createElement("path",{d:"M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5z"}),"CallMade");return x.default=c,x}var rt=at();const ct=T(rt);var w={},Z;function it(){if(Z)return w;Z=1;var n=_();Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var e=n(E()),a=n(q()),c=(0,a.default)(e.default.createElement("path",{d:"M20 5.41L18.59 4 7 15.59V9H5v10h10v-2H8.41z"}),"CallReceived");return w.default=c,w}var ot=it();const G=T(ot),st=n=>Array.from(new Set(n)),lt=()=>{};function ut(...n){return n.reduce((e,a)=>e.add(a),f(0))}function mt(n){return n.animate?t.createElement(Re,{appear:!0,enter:!1,in:!0,timeout:{enter:1e3}},n.children):t.createElement(t.Fragment,null,n.children)}function k(n){const{amount:e,buying:a,offerId:c,price:s,selling:o}=n,{t:i}=h();let r;return c==="0"?r=`${i("account.transactions.transaction-list.offer-description.prefix.default")}: `:e.eq(0)?r=`${i("account.transactions.transaction-list.offer-description.prefix.cancel")}: `:r=`${i("account.transactions.transaction-list.offer-description.prefix.update")}: `,t.createElement(t.Fragment,null,r,n.type==="manageBuyOffer"?i("account.transactions.transaction-list.offer-description.buy",`Buy ${e.eq(0)?"":y(e.toString())} ${a.code} for ${e.eq(0)?"":y(e.mul(s).toString())} ${o.code}`,{buyingAmount:e.eq(0)?"":y(e.toString()),buyingCode:a.code,sellingAmount:e.eq(0)?"":y(e.mul(s).toString()),sellingCode:o.code}):i("account.transactions.transaction-list.offer-description.sell",`Sell ${e.eq(0)?"":y(e.toString())} ${o.code} for ${e.eq(0)?"":y(e.mul(s).toString())} ${a.code}`,{buyingAmount:e.eq(0)?"":y(e.mul(s).toString()),buyingCode:a.code,sellingAmount:e.eq(0)?"":y(e.toString()),sellingCode:o.code}))}function J(n){const{t:e}=h();return n.publicKeys.length===0?t.createElement(t.Fragment,null,"-"):n.publicKeys.length===1?t.createElement(g,{publicKey:n.publicKeys[0],testnet:n.testnet,variant:n.short?"short":"full"}):t.createElement(t.Fragment,null,t.createElement(g,{publicKey:n.publicKeys[0],testnet:n.testnet,variant:"short"})," ",t.createElement("i",null,"+ ",n.publicKeys.length-1," ",e("account.transactions.transaction-list.item.remote-public-keys.more")))}const dt=t.memo(function(e){const a=new Date(e.time);return t.createElement("span",{style:{whiteSpace:"nowrap"}},t.createElement(nt,{time:a.getTime()}))});function yt(n){return n.transaction.operations.length===1&&["manageBuyOffer","manageSellOffer"].includes(n.transaction.operations[0].type)?t.createElement(U,null):n.transaction.operations.length===1&&n.transaction.operations[0].type==="changeTrust"?f(n.transaction.operations[0].limit).eq(0)?t.createElement(ze,null):t.createElement(he,null):n.transaction.operations.every(e=>e.type==="accountMerge")?t.createElement(G,null):n.paymentSummary.length===0?t.createElement(Me,null):n.paymentSummary.every(e=>e.balanceChange.gt(0))?t.createElement(G,null):n.paymentSummary.every(e=>e.balanceChange.lt(0))?t.createElement(ct,null):t.createElement(U,null)}const ft=t.memo(function(e){const a=Ie(),{t:c}=h(),s=e.paymentSummary.reduce((r,u)=>r.concat(u.publicKeys),[]),o=e.transaction.networkPassphrase===ve.Networks.TESTNET,i=t.useMemo(()=>t.createElement("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis"}},t.createElement(dt,{time:e.createdAt}),e.showMemo&&e.transaction.memo.type!=="none"?t.createElement(t.Fragment,null,"  |  ",t.createElement(Ke,{prefix:t.createElement(t.Fragment,null,c("account.transactions.transaction-list.item.memo"),": "),memo:e.transaction.memo})):null),[e.createdAt,e.showMemo,e.transaction,c]);if(s.length>0&&e.paymentSummary.every(r=>r.balanceChange.gt(0)))return t.createElement(d,{primary:t.createElement("span",null,c("account.transactions.transaction-list.item.from")," ",t.createElement(J,{publicKeys:s,short:!0,testnet:o})),primaryTypographyProps:{style:e.style},secondary:i,style:e.style});if(s.length>0&&e.paymentSummary.every(r=>r.balanceChange.lt(0)))return t.createElement(d,{primary:t.createElement("span",null,c("account.transactions.transaction-list.item.to")," ",t.createElement(J,{publicKeys:s,short:!0,testnet:o}),e.alwaysShowSource?t.createElement("span",null," ",c("account.transactions.transaction-list.item.from")," ",t.createElement(g,{publicKey:e.accountPublicKey,testnet:o,variant:"short"})," "):null),primaryTypographyProps:{style:e.style},secondary:i,style:e.style});if(e.transaction.operations.length===1&&e.transaction.operations[0].type==="changeTrust"){const r=e.transaction.operations[0];return f(r.limit).eq(0)?t.createElement(d,{primary:t.createElement("span",null,c("account.transactions.transaction-list.item.trust.remove-trust",`Remove trust in asset ${K(r.line)}`,{asset:K(r.line)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(g,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:i,style:e.style}):t.createElement(d,{primary:t.createElement("span",null,c("account.transactions.transaction-list.item.trust.add-trust",`Trust asset ${K(r.line)}`,{asset:K(r.line)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(g,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:i,style:e.style})}else if(e.transaction.operations.length===1&&["manageBuyOffer","manageSellOffer"].includes(e.transaction.operations[0].type)){const r=e.transaction.operations[0],u=f(r.type==="manageBuyOffer"?r.buyAmount:r.amount);return String(r.offerId)==="0"?t.createElement(d,{primary:t.createElement("span",null,t.createElement(k,{...r,amount:u,price:f(r.price)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(g,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:i,style:e.style}):u.eq(0)?t.createElement(d,{primary:t.createElement("span",null,t.createElement(k,{...r,amount:f(0),price:f(r.price)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(g,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:i,style:e.style}):t.createElement(d,{primary:t.createElement("span",null,t.createElement(k,{...r,amount:u,price:f(r.price)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(g,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:i,style:e.style})}else{const r=e.transaction.operations.map(a);return t.createElement(d,{primary:t.createElement("span",null,st(r).join(", ")),primaryTypographyProps:{style:e.style},secondary:i,style:e.style})}});function gt(n){const{paymentSummary:e}=n,a=P(),c=n.transaction.operations.filter(i=>i.type==="createAccount"),s=n.transaction.operations.filter(i=>i.type==="payment"),o=e.every(i=>i.publicKeys.every(r=>r===n.accountPublicKey))?ut(...c.map(i=>i.startingBalance),...s.map(i=>i.amount)):e[0].balanceChange;return t.createElement(d,{primaryTypographyProps:{align:"right"},style:{flexShrink:0,...n.style}},e.length===0?null:t.createElement(Pe,{assetCode:e[0].asset.getCode(),balance:o.toString(),style:a?{fontSize:"1rem"}:{fontSize:"1.4rem"}}))}const ce=t.memo(function(e){const{hideMemos:a}=t.useContext(A),c=P(),{transaction:s,onOpenTransaction:o}=e,i=_e(e.accountPublicKey,s),r=o?()=>o(s.hash().toString("hex")):void 0;return t.createElement(ne,{button:!!r,className:e.className||"",onClick:r,style:e.style},t.createElement(qe,{style:{marginRight:c?0:void 0}},e.icon||t.createElement(yt,{paymentSummary:i,transaction:s})),t.createElement(ft,{accountPublicKey:e.accountPublicKey,alwaysShowSource:e.alwaysShowSource,createdAt:e.createdAt,paymentSummary:i,showMemo:!a,style:{fontSize:c?"0.8rem":void 0,fontWeight:"bold",overflow:"hidden",paddingRight:0,textOverflow:"ellipsis"},transaction:s}),t.createElement(gt,{accountPublicKey:e.accountPublicKey,paymentSummary:i,style:{paddingRight:0},transaction:s}))}),ht=t.memo(function(e){const{t:a}=h();return t.createElement(ne,{style:{borderBottom:"none",height:75}},t.createElement(d,{disableTypography:!0,style:{textAlign:"center"}},t.createElement(ge,{onClick:e.onClick,loading:e.pending,style:{margin:"0 auto",paddingLeft:16,paddingRight:16},variant:"text"},a("account.transactions.transaction-list.load-more.label"))))}),vt=X({listItem:{padding:"8px 24px",[te.down(600)]:{paddingLeft:24,paddingRight:24}}});function bt(n){const e=vt(),a=P(),c=M(),s=F(c.location.pathname,R("*","*"))?c.match.params.subaction:null,o=t.useMemo(()=>{if(!s)return null;const l=n.transactions.find(v=>v.hash===s),m=l?l.decodedTx:null;return m&&l?Object.assign(m,{created_at:l.created_at}):m},[s,n.transactions]),i=t.useCallback(l=>{c.history.push(R(n.account.id,l))},[n.account.id,c.history]),r=t.useCallback(()=>{c.history.push(xe(n.account.id)),setTimeout(()=>{document.activeElement&&document.activeElement.blur()},0)},[n.account.id,c.history]),u=t.useMemo(()=>t.createElement(t.Fragment,null,n.transactions.map(l=>t.createElement(mt,{key:l.hash,animate:Date.now()-new Date(l.created_at).getTime()<1e4},t.createElement(ee,{height:72},t.createElement(ce,{key:l.hash,accountPublicKey:n.account.publicKey,className:e.listItem,createdAt:l.created_at,onOpenTransaction:i,transaction:l.decodedTx}))))),[n.transactions,n.account.publicKey,e.listItem,i]);return n.transactions.length===0&&!n.olderTransactionsAvailable?null:t.createElement(D,{disablePadding:a,style:{background:n.background}},t.createElement(H,{className:e.listItem,disableSticky:!0,style:{background:n.background}},n.title),u,n.olderTransactionsAvailable?t.createElement(ht,{pending:n.loadingMoreTransactions,onClick:n.onFetchMoreTransactions}):null,t.createElement(we,{open:o!==null,account:n.account,disabled:!0,showSource:!0,showSubmissionProgress:!1,transaction:o,onClose:r,onSubmitTransaction:lt}))}const Et=t.memo(bt);function Tt(n){const{onOpenTransaction:e,signatureRequest:a}=n,c=t.useMemo(()=>new ae(a.req).getTransaction(),[a.req]),s=t.useCallback(e?()=>e(c,a):()=>{},[e,a,c]);return t.createElement(ce,{alwaysShowSource:!0,accountPublicKey:c.source,createdAt:a.created_at,icon:n.icon,onOpenTransaction:s,style:n.style,transaction:c})}const St=t.memo(function(e){const{sendTransaction:a}=e,c=M();t.useEffect(()=>{const o=r=>{if(F(r,R("*","*"))){const[,,,u]=r.replace(/^\//,"").split("/"),l=e.signatureRequests.find(m=>m.hash===u);if(l){const m=new ae(l.req);a(m.getTransaction(),l)}}};return o(c.location.pathname),c.history.listen(r=>{o(r.pathname)})},[c.history,c.location.pathname,a,e.signatureRequests]);const s=(o,i)=>{c.history.push(R(e.account.id,i.hash))};return e.signatureRequests.length===0?null:t.createElement(t.Fragment,null,t.createElement(D,{style:{background:"transparent"}},t.createElement(H,{disableSticky:!0,style:{background:"transparent"}},e.title),e.signatureRequests.map(o=>t.createElement(ee,{height:72,key:o.hash},t.createElement(Tt,{icon:e.icon,onOpenTransaction:s,signatureRequest:o,style:{minHeight:72}})))))}),Q=t.memo(n=>{const e=M(),a=!F(e.location.pathname,R("*","*")),c=t.useCallback(()=>{e.history.push(Le(e.location.pathname))},[e]);return t.createElement(Oe,{account:n.account,forceClose:a,onCloseTransactionDialog:c},({sendTransaction:s})=>t.createElement(St,{account:n.account,icon:n.icon,sendTransaction:s,signatureRequests:n.signatureRequests,title:n.title}))}),pt=X({list:{paddingBottom:0},header:{padding:"8px 24px 0px 24px",lineHeight:1,alignItems:"center",display:"flex",cursor:"pointer",[te.down(600)]:{paddingLeft:24,paddingRight:24}}});function Ct(n){const e=pt(),a=M(),c=be(n.account.accountID,n.account.testnet),{t:s}=h(),o=()=>{a.history.push(Ae(n.account.id))};return c.offers.length?t.createElement(D,{className:e.list},t.createElement(H,{className:e.header,disableSticky:!0,onClick:o},s("account.transactions.offer-list.title")," (",c.offers.length,c.olderOffersAvailable?"+":"",") ",t.createElement(ke,null))):null}const xt=(n,e)=>!e.decodedTx.operations.every(a=>a.type==="createClaimableBalance"||a.type==="claimClaimableBalance"&&a.source!==n.publicKey),wt=(n,e)=>!Fe(e.decodedTx,n);function Rt(n){const{pendingSignatureRequests:e}=t.useContext(Ce),{t:a}=h(),c=t.useMemo(()=>t.createElement(je,null),[]),s=t.useMemo(()=>t.createElement(He,{style:{opacity:.5}}),[]),o=t.useMemo(()=>e.filter(r=>r.status!=="submitted"&&r.signers.some(u=>u===n.account.publicKey)&&r.signed_by.indexOf(n.account.publicKey)===-1),[n.account,e]),i=t.useMemo(()=>e.filter(r=>r.status!=="submitted"&&r.signers.some(u=>u===n.account.publicKey)&&r.signed_by.indexOf(n.account.publicKey)>-1),[n.account,e]);return t.createElement(t.Fragment,null,t.createElement(Q,{account:n.account,icon:c,signatureRequests:o,title:a("account.transactions.signature-request-list.title.requests-to-cosign")}),t.createElement(Q,{account:n.account,icon:s,signatureRequests:i,title:a("account.transactions.signature-request-list.title.requests-waiting-for-others")}))}function _t(n){const{account:e}=n,{showDust:a,showClaimableBalanceTxs:c}=t.useContext(A),{t:s}=h(),o=Ee(e.accountID,e.testnet),i=Te(e.testnet),r=P(),[u,l]=Se(),m=t.useCallback(le=>le.filter(z=>(c||xt(e,z))&&(a||wt(e,z))),[]),{transactions:v,olderTransactionsAvailable:L,fetchMoreTransactions:I}=Ye(e.accountID,e.testnet,m),B=M(),ie=t.useContext(A),oe=t.useCallback(()=>l(I()),[I,l]),se=t.useCallback(()=>B.history.push(De(e.id)),[e,B]);return t.createElement(t.Fragment,null,o.balances.length>0?t.createElement(t.Fragment,null,ie.multiSignature?t.createElement(Rt,{account:e}):null,t.createElement(Ct,{account:e}),t.createElement(Et,{account:e,background:"transparent",loadingMoreTransactions:u.type==="pending",olderTransactionsAvailable:L,onFetchMoreTransactions:oe,title:s("account.transactions.transaction-list.title"),transactions:v})):t.createElement(t.Fragment,null,t.createElement(pe,{alignItems:"stretch",margin:"0 auto",style:{padding:r?"16px 28px":"32px 28px",width:"fit-content"}},e.testnet?t.createElement(Qe,{horizonURL:i[0],publicKey:e.publicKey,style:{marginBottom:r?16:32}}):null,t.createElement(re,{Icon:We,description:s("account.transactions.action.navigate-to-deposit.description"),label:s("account.transactions.action.navigate-to-deposit.label"),onClick:se}))))}const Ot=t.memo(_t);export{Ot as default};
//# sourceMappingURL=AccountTransactions-DboFZJx0.js.map
