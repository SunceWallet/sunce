import{i as oe,R as t,_ as se,f as le,j as ue,k as me,U as O,V as I,W as A,g as q,cb as de,cc as ye,$ as b,am as fe,cd as ge,aM as he,Z,a9 as K,a2 as w,bt as Q,bv as D,ai as X,af as P,H as ee,ax as d,a1 as be,ap as g,bK as Ee,a6 as ve,bu as h,az as _,ce as te,aE as Se,Y as Te,bN as pe,c7 as xe,al as Ce,bJ as we}from"./app-TIsuwqEK.js";import{k as F,a5 as C,b as Re,a6 as _e,n as Ie,a7 as qe,L as Ke,a8 as ke,a9 as Me,aa as Le,S as Pe,p as f,ab as Oe,T as Ae,t as B,O as De,ac as Fe,ad as $e,ae as ze}from"./app-stage2-D0Y65gPS.js";import{M as ne}from"./MainSelectionButton-DvyegE7k.js";import{r as Be}from"./util-Be5JXldS.js";import{C as H,a as He}from"./CallReceived-CyOOxHqD.js";import{R as Ne}from"./Remove-BtxFAsse.js";import{S as N}from"./SwapHoriz-DB9i3lV2.js";var Ue=function(e){return{root:{boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:e.palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14)},colorPrimary:{color:e.palette.primary.main},colorInherit:{color:"inherit"},gutters:{paddingLeft:16,paddingRight:16},inset:{paddingLeft:72},sticky:{position:"sticky",top:0,zIndex:1,backgroundColor:"inherit"}}},je=t.forwardRef(function(e,r){var i=e.classes,s=e.className,o=e.color,c=o===void 0?"default":o,a=e.component,u=a===void 0?"li":a,l=e.disableGutters,m=l===void 0?!1:l,y=e.disableSticky,S=y===void 0?!1:y,E=e.inset,R=E===void 0?!1:E,k=se(e,["classes","className","color","component","disableGutters","disableSticky","inset"]);return t.createElement(u,le({className:ue(i.root,s,c!=="default"&&i["color".concat(me(c))],R&&i.inset,!S&&i.sticky,!m&&i.gutters),ref:r},k))});const $=oe(Ue,{name:"MuiListSubheader"})(je);var T={},U;function We(){if(U)return T;U=1;var n=O();Object.defineProperty(T,"__esModule",{value:!0}),T.default=void 0;var e=n(I()),r=n(A()),i=(0,r.default)(e.default.createElement("path",{d:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"}),"DoneAll");return T.default=i,T}var Ve=We();const Ge=q(Ve);var p={},j;function Je(){if(j)return p;j=1;var n=O();Object.defineProperty(p,"__esModule",{value:!0}),p.default=void 0;var e=n(I()),r=n(A()),i=(0,r.default)(e.default.createElement("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"}),"CreditCard");return p.default=i,p}var Ye=Je();const Ze=q(Ye);function Qe(n,e,r){const[i,s]=t.useState(Date.now()),o=15,{transactions:c,olderTransactionsAvailable:a}=de(n,e,i),u=ye(n,e),l=t.useMemo(()=>r(c),[c]),m=async(y=0)=>{if(y>=o){s(Date.now());return}const S=await u(),E=r(S);return m(y+E.length)};return t.useEffect(()=>{l.length<o&&m(l.length)},[l]),{olderTransactionsAvailable:a,transactions:l,fetchMoreTransactions:m}}var x={},W;function Xe(){if(W)return x;W=1;var n=O();Object.defineProperty(x,"__esModule",{value:!0}),x.default=void 0;var e=n(I()),r=n(A()),i=(0,r.default)(e.default.createElement("path",{d:"M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"}),"ThumbUp");return x.default=i,x}var et=Xe();const tt=q(et);function nt(n){const[e,r]=t.useState(!1),{t:i}=b(),s=async()=>{try{r(!0),await ge(n.horizonURL,n.publicKey)}catch(o){r(!1),he(o)}};return t.createElement(ne,{Icon:e?fe:tt,className:n.className,description:i("account.transactions.action.friendbot.description"),label:i("account.transactions.action.friendbot.label"),onClick:s,style:n.style})}var v={},M,V;function at(){if(V)return M;V=1;var n=Be();M=e;function e(r){r instanceof Date&&(r=Math.round((Date.now()-r)/1e3));var i=r<0?"from now":"ago";r=Math.abs(r);for(var s=[r/60/60/24/365,r/60/60/24/30,r/60/60/24/7,r/60/60/24,r/60/60,r/60,r],o=["year","month","week","day","hour","minute","second"],c=0;c<o.length;c++){var a=Math.floor(s[c]);if(a>1)return n.format("%d %ss %s",a,o[c],i);if(a===1)return n.format("%d %s %s",a,o[c],i)}return n.format("0 seconds %s",i)}return M}var G;function rt(){if(G)return v;G=1;var n=v&&v.__extends||function(){var s=function(o,c){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,u){a.__proto__=u}||function(a,u){for(var l in u)u.hasOwnProperty(l)&&(a[l]=u[l])},s(o,c)};return function(o,c){s(o,c);function a(){this.constructor=o}o.prototype=c===null?Object.create(c):(a.prototype=c.prototype,new a)}}();Object.defineProperty(v,"__esModule",{value:!0});var e=I(),r=at(),i=function(s){n(o,s);function o(c){var a=s.call(this,c)||this;return a.state=a.getStateFromProps(c),a}return o.prototype.getStateFromProps=function(c){return{formattedTime:r(new Date(c.time)).replace(/minute/,"min").replace(/^.*second.*$/,"now")}},o.prototype.componentDidMount=function(){var c=this;this._timer=setInterval(function(){return c.setState(c.getStateFromProps(c.props))},this.props.period||3e4)},o.prototype.componentWillUnmount=function(){clearInterval(this._timer)},o.prototype.render=function(){return this.state.formattedTime},o}(e.Component);return v.default=i,v}var ct=rt();const it=q(ct),ot=n=>Array.from(new Set(n)),st=()=>{};function lt(...n){return n.reduce((e,r)=>e.add(r),g(0))}function ut(n){return n.animate?t.createElement(Ie,{appear:!0,enter:!1,in:!0,timeout:{enter:1e3}},n.children):t.createElement(t.Fragment,null,n.children)}function L(n){const{amount:e,buying:r,offerId:i,price:s,selling:o}=n,{t:c}=b();let a;return i==="0"?a=`${c("account.transactions.transaction-list.offer-description.prefix.default")}: `:e.eq(0)?a=`${c("account.transactions.transaction-list.offer-description.prefix.cancel")}: `:a=`${c("account.transactions.transaction-list.offer-description.prefix.update")}: `,t.createElement(t.Fragment,null,a,n.type==="manageBuyOffer"?c("account.transactions.transaction-list.offer-description.buy",`Buy ${e.eq(0)?"":f(e.toString())} ${r.code} for ${e.eq(0)?"":f(e.mul(s).toString())} ${o.code}`,{buyingAmount:e.eq(0)?"":f(e.toString()),buyingCode:r.code,sellingAmount:e.eq(0)?"":f(e.mul(s).toString()),sellingCode:o.code}):c("account.transactions.transaction-list.offer-description.sell",`Sell ${e.eq(0)?"":f(e.toString())} ${o.code} for ${e.eq(0)?"":f(e.mul(s).toString())} ${r.code}`,{buyingAmount:e.eq(0)?"":f(e.mul(s).toString()),buyingCode:r.code,sellingAmount:e.eq(0)?"":f(e.toString()),sellingCode:o.code}))}function J(n){const{t:e}=b();return n.publicKeys.length===0?t.createElement(t.Fragment,null,"-"):n.publicKeys.length===1?t.createElement(h,{publicKey:n.publicKeys[0],testnet:n.testnet,variant:n.short?"short":"full"}):t.createElement(t.Fragment,null,t.createElement(h,{publicKey:n.publicKeys[0],testnet:n.testnet,variant:"short"})," ",t.createElement("i",null,"+ ",n.publicKeys.length-1," ",e("account.transactions.transaction-list.item.remote-public-keys.more")))}const mt=t.memo(function(e){const r=new Date(e.time);return t.createElement("span",{style:{whiteSpace:"nowrap"}},t.createElement(it,{time:r.getTime()}))});function dt(n){return n.transaction.operations.length===1&&["manageBuyOffer","manageSellOffer"].includes(n.transaction.operations[0].type)?t.createElement(N,null):n.transaction.operations.length===1&&n.transaction.operations[0].type==="changeTrust"?g(n.transaction.operations[0].limit).eq(0)?t.createElement(Ne,null):t.createElement(Ee,null):n.transaction.operations.every(e=>e.type==="accountMerge")?t.createElement(H,null):n.paymentSummary.length===0?t.createElement(ke,null):n.paymentSummary.every(e=>e.balanceChange.gt(0))?t.createElement(H,null):n.paymentSummary.every(e=>e.balanceChange.lt(0))?t.createElement(He,null):t.createElement(N,null)}const yt=t.memo(function(e){const r=Me(),{t:i}=b(),s=e.paymentSummary.reduce((a,u)=>a.concat(u.publicKeys),[]),o=e.transaction.networkPassphrase===ve.Networks.TESTNET,c=t.useMemo(()=>t.createElement("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis"}},t.createElement(mt,{time:e.createdAt}),e.showMemo&&e.transaction.memo.type!=="none"?t.createElement(t.Fragment,null,"  |  ",t.createElement(Le,{prefix:t.createElement(t.Fragment,null,i("account.transactions.transaction-list.item.memo"),": "),memo:e.transaction.memo})):null),[e.createdAt,e.showMemo,e.transaction,i]);if(s.length>0&&e.paymentSummary.every(a=>a.balanceChange.gt(0)))return t.createElement(d,{primary:t.createElement("span",null,i("account.transactions.transaction-list.item.from")," ",t.createElement(J,{publicKeys:s,short:!0,testnet:o})),primaryTypographyProps:{style:e.style},secondary:c,style:e.style});if(s.length>0&&e.paymentSummary.every(a=>a.balanceChange.lt(0)))return t.createElement(d,{primary:t.createElement("span",null,i("account.transactions.transaction-list.item.to")," ",t.createElement(J,{publicKeys:s,short:!0,testnet:o}),e.alwaysShowSource?t.createElement("span",null," ",i("account.transactions.transaction-list.item.from")," ",t.createElement(h,{publicKey:e.accountPublicKey,testnet:o,variant:"short"})," "):null),primaryTypographyProps:{style:e.style},secondary:c,style:e.style});if(e.transaction.operations.length===1&&e.transaction.operations[0].type==="changeTrust"){const a=e.transaction.operations[0];return g(a.limit).eq(0)?t.createElement(d,{primary:t.createElement("span",null,i("account.transactions.transaction-list.item.trust.remove-trust",`Remove trust in asset ${_(a.line)}`,{asset:_(a.line)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(h,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:c,style:e.style}):t.createElement(d,{primary:t.createElement("span",null,i("account.transactions.transaction-list.item.trust.add-trust",`Trust asset ${_(a.line)}`,{asset:_(a.line)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(h,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:c,style:e.style})}else if(e.transaction.operations.length===1&&["manageBuyOffer","manageSellOffer"].includes(e.transaction.operations[0].type)){const a=e.transaction.operations[0],u=g(a.type==="manageBuyOffer"?a.buyAmount:a.amount);return String(a.offerId)==="0"?t.createElement(d,{primary:t.createElement("span",null,t.createElement(L,{...a,amount:u,price:g(a.price)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(h,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:c,style:e.style}):u.eq(0)?t.createElement(d,{primary:t.createElement("span",null,t.createElement(L,{...a,amount:g(0),price:g(a.price)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(h,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:c,style:e.style}):t.createElement(d,{primary:t.createElement("span",null,t.createElement(L,{...a,amount:u,price:g(a.price)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(h,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:c,style:e.style})}else{const a=e.transaction.operations.map(r);return t.createElement(d,{primary:t.createElement("span",null,ot(a).join(", ")),primaryTypographyProps:{style:e.style},secondary:c,style:e.style})}});function ft(n){const{paymentSummary:e}=n,r=K(),i=n.transaction.operations.filter(c=>c.type==="createAccount"),s=n.transaction.operations.filter(c=>c.type==="payment"),o=e.every(c=>c.publicKeys.every(a=>a===n.accountPublicKey))?lt(...i.map(c=>c.startingBalance),...s.map(c=>c.amount)):e[0].balanceChange;return t.createElement(d,{primaryTypographyProps:{align:"right"},style:{flexShrink:0,...n.style}},e.length===0?null:t.createElement(Pe,{assetCode:e[0].asset.getCode(),balance:o.toString(),style:r?{fontSize:"1rem"}:{fontSize:"1.4rem"}}))}const ae=t.memo(function(e){const{hideMemos:r}=t.useContext(P),i=K(),{transaction:s,onOpenTransaction:o}=e,c=qe(e.accountPublicKey,s),a=o?()=>o(s.hash().toString("hex")):void 0;return t.createElement(ee,{button:!!a,className:e.className||"",onClick:a,style:e.style},t.createElement(Ke,{style:{marginRight:i?0:void 0}},e.icon||t.createElement(dt,{paymentSummary:c,transaction:s})),t.createElement(yt,{accountPublicKey:e.accountPublicKey,alwaysShowSource:e.alwaysShowSource,createdAt:e.createdAt,paymentSummary:c,showMemo:!r,style:{fontSize:i?"0.8rem":void 0,fontWeight:"bold",overflow:"hidden",paddingRight:0,textOverflow:"ellipsis"},transaction:s}),t.createElement(ft,{accountPublicKey:e.accountPublicKey,paymentSummary:c,style:{paddingRight:0},transaction:s}))}),gt=t.memo(function(e){const{t:r}=b();return t.createElement(ee,{style:{borderBottom:"none",height:75}},t.createElement(d,{disableTypography:!0,style:{textAlign:"center"}},t.createElement(be,{onClick:e.onClick,loading:e.pending,style:{margin:"0 auto",paddingLeft:16,paddingRight:16},variant:"text"},r("account.transactions.transaction-list.load-more.label"))))}),ht=Z({listItem:{padding:"8px 24px",[X.down(600)]:{paddingLeft:24,paddingRight:24}}});function bt(n){const e=ht(),r=K(),i=w(),s=F(i.location.pathname,C("*","*"))?i.match.params.subaction:null,o=t.useMemo(()=>{if(!s)return null;const l=n.transactions.find(y=>y.hash===s),m=l?l.decodedTx:null;return m&&l?Object.assign(m,{created_at:l.created_at}):m},[s,n.transactions]),c=t.useCallback(l=>{i.history.push(C(n.account.id,l))},[n.account.id,i.history]),a=t.useCallback(()=>{i.history.push(Re(n.account.id)),setTimeout(()=>{document.activeElement&&document.activeElement.blur()},0)},[n.account.id,i.history]),u=t.useMemo(()=>t.createElement(t.Fragment,null,n.transactions.map(l=>t.createElement(ut,{key:l.hash,animate:Date.now()-new Date(l.created_at).getTime()<1e4},t.createElement(Q,{height:72},t.createElement(ae,{key:l.hash,accountPublicKey:n.account.publicKey,className:e.listItem,createdAt:l.created_at,onOpenTransaction:c,transaction:l.decodedTx}))))),[n.transactions,n.account.publicKey,e.listItem,c]);return n.transactions.length===0&&!n.olderTransactionsAvailable?null:t.createElement(D,{disablePadding:r,style:{background:n.background}},t.createElement($,{className:e.listItem,disableSticky:!0,style:{background:n.background}},n.title),u,n.olderTransactionsAvailable?t.createElement(gt,{pending:n.loadingMoreTransactions,onClick:n.onFetchMoreTransactions}):null,t.createElement(_e,{open:o!==null,account:n.account,disabled:!0,showSource:!0,showSubmissionProgress:!1,transaction:o,onClose:a,onSubmitTransaction:st}))}const Et=t.memo(bt);function vt(n){const{onOpenTransaction:e,signatureRequest:r}=n,i=t.useMemo(()=>new te(r.req).getTransaction(),[r.req]),s=t.useCallback(e?()=>e(i,r):()=>{},[e,r,i]);return t.createElement(ae,{alwaysShowSource:!0,accountPublicKey:i.source,createdAt:r.created_at,icon:n.icon,onOpenTransaction:s,style:n.style,transaction:i})}const St=t.memo(function(e){const{sendTransaction:r}=e,i=w();t.useEffect(()=>{const o=a=>{if(F(a,C("*","*"))){const[,,,u]=a.replace(/^\//,"").split("/"),l=e.signatureRequests.find(m=>m.hash===u);if(l){const m=new te(l.req);r(m.getTransaction(),l)}}};return o(i.location.pathname),i.history.listen(a=>{o(a.pathname)})},[i.history,i.location.pathname,r,e.signatureRequests]);const s=(o,c)=>{i.history.push(C(e.account.id,c.hash))};return e.signatureRequests.length===0?null:t.createElement(t.Fragment,null,t.createElement(D,{style:{background:"transparent"}},t.createElement($,{disableSticky:!0,style:{background:"transparent"}},e.title),e.signatureRequests.map(o=>t.createElement(Q,{height:72,key:o.hash},t.createElement(vt,{icon:e.icon,onOpenTransaction:s,signatureRequest:o,style:{minHeight:72}})))))}),Y=t.memo(n=>{const e=w(),r=!F(e.location.pathname,C("*","*")),i=t.useCallback(()=>{e.history.push(Oe(e.location.pathname))},[e]);return t.createElement(Ae,{account:n.account,forceClose:r,onCloseTransactionDialog:i},({sendTransaction:s})=>t.createElement(St,{account:n.account,icon:n.icon,sendTransaction:s,signatureRequests:n.signatureRequests,title:n.title}))}),Tt=Z({list:{paddingBottom:0},header:{padding:"8px 24px 0px 24px",lineHeight:1,alignItems:"center",display:"flex",cursor:"pointer",[X.down(600)]:{paddingLeft:24,paddingRight:24}}});function pt(n){const e=Tt(),r=w(),i=Se(n.account.accountID,n.account.testnet),{t:s}=b();console.log(B(n.account.id));const o=()=>{r.history.push(B(n.account.id))};return i.offers.length?t.createElement(D,{className:e.list},t.createElement($,{className:e.header,disableSticky:!0,onClick:o},s("account.transactions.offer-list.title")," (",i.offers.length,i.olderOffersAvailable?"+":"",") ",t.createElement(De,null))):null}const xt=(n,e)=>!e.decodedTx.operations.every(r=>r.type==="createClaimableBalance"||r.type==="claimClaimableBalance"&&r.source!==n.publicKey),Ct=(n,e)=>!$e(e.decodedTx,n);function wt(n){const{pendingSignatureRequests:e}=t.useContext(we),{t:r}=b(),i=t.useMemo(()=>t.createElement(Ge,null),[]),s=t.useMemo(()=>t.createElement(ze,{style:{opacity:.5}}),[]),o=t.useMemo(()=>e.filter(a=>a.status!=="submitted"&&a.signers.some(u=>u===n.account.publicKey)&&a.signed_by.indexOf(n.account.publicKey)===-1),[n.account,e]),c=t.useMemo(()=>e.filter(a=>a.status!=="submitted"&&a.signers.some(u=>u===n.account.publicKey)&&a.signed_by.indexOf(n.account.publicKey)>-1),[n.account,e]);return t.createElement(t.Fragment,null,t.createElement(Y,{account:n.account,icon:i,signatureRequests:o,title:r("account.transactions.signature-request-list.title.requests-to-cosign")}),t.createElement(Y,{account:n.account,icon:s,signatureRequests:c,title:r("account.transactions.signature-request-list.title.requests-waiting-for-others")}))}function Rt(n){const{account:e}=n,{showDust:r,showClaimableBalanceTxs:i}=t.useContext(P),{t:s}=b(),o=Te(e.accountID,e.testnet),c=pe(e.testnet),a=K(),[u,l]=xe(),m=t.useCallback(ie=>ie.filter(z=>(i||xt(e,z))&&(r||Ct(e,z))),[]),{transactions:y,olderTransactionsAvailable:S,fetchMoreTransactions:E}=Qe(e.accountID,e.testnet,m),R=w(),k=t.useContext(P),re=t.useCallback(()=>l(E()),[E,l]),ce=t.useCallback(()=>R.history.push(Fe(e.id)),[e,R]);return t.createElement(t.Fragment,null,o.balances.length>0?t.createElement(t.Fragment,null,k.multiSignature?t.createElement(wt,{account:e}):null,t.createElement(pt,{account:e}),t.createElement(Et,{account:e,background:"transparent",loadingMoreTransactions:u.type==="pending",olderTransactionsAvailable:S,onFetchMoreTransactions:re,title:s("account.transactions.transaction-list.title"),transactions:y})):t.createElement(t.Fragment,null,t.createElement(Ce,{alignItems:"stretch",margin:"0 auto",style:{padding:a?"16px 28px":"32px 28px",width:"fit-content"}},e.testnet?t.createElement(nt,{horizonURL:c[0],publicKey:e.publicKey,style:{marginBottom:a?16:32}}):null,t.createElement(ne,{Icon:Ze,description:s("account.transactions.action.navigate-to-deposit.description"),label:s("account.transactions.action.navigate-to-deposit.label"),onClick:ce}))))}const Pt=t.memo(Rt);export{Pt as default};
//# sourceMappingURL=AccountTransactions-CfVLU5Om.js.map
