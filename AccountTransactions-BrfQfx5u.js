import{U as L,V as R,W as O,g as q,R as t,cc as ie,cd as oe,$ as h,am as se,ce as le,aM as ue,Z,a9 as I,a2 as w,bu as G,bw as k,ai as J,af as P,H as Q,ax as y,a1 as me,ap as f,bL as ye,a6 as de,bv as g,az as x,cf as X,aE as fe,Y as ge,bO as he,c8 as be,al as Ee,bK as ve}from"./app-CBe6B6ye.js";import{p as A,aa as p,b as Te,ab as D,ac as Se,v as pe,ad as we,L as Ce,ae as xe,af as Re,ag as qe,e as Ie,w as d,ah as Ke,T as _e,Y as Me,t as Pe,ai as Le,aj as Oe,ak as ke}from"./app-stage2-hjtW8VzK.js";import{M as ee}from"./MainSelectionButton-CmCz_H6p.js";import{r as Ae}from"./util-IvzS1fyL.js";import{C as H,a as De}from"./CallReceived-aJZEAbo3.js";import{R as Fe}from"./Remove-Lzt6qr6m.js";import{S as z}from"./SwapHoriz-Coq54KR5.js";var v={},U;function Be(){if(U)return v;U=1;var n=L();Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var e=n(R()),r=n(O()),i=(0,r.default)(e.default.createElement("path",{d:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"}),"DoneAll");return v.default=i,v}var He=Be();const ze=q(He);var T={},$;function Ue(){if($)return T;$=1;var n=L();Object.defineProperty(T,"__esModule",{value:!0}),T.default=void 0;var e=n(R()),r=n(O()),i=(0,r.default)(e.default.createElement("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"}),"CreditCard");return T.default=i,T}var $e=Ue();const Ne=q($e);function je(n,e,r){const[i,s]=t.useState(Date.now()),o=15,{transactions:c,olderTransactionsAvailable:a}=ie(n,e,i),u=oe(n,e),l=t.useMemo(()=>r(c),[c]),m=async(b=0)=>{if(b>=o){s(Date.now());return}const K=await u(),C=r(K);return m(b+C.length)};return t.useEffect(()=>{l.length<o&&m(l.length)},[l]),{olderTransactionsAvailable:a,transactions:l,fetchMoreTransactions:m}}var S={},N;function Ve(){if(N)return S;N=1;var n=L();Object.defineProperty(S,"__esModule",{value:!0}),S.default=void 0;var e=n(R()),r=n(O()),i=(0,r.default)(e.default.createElement("path",{d:"M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"}),"ThumbUp");return S.default=i,S}var We=Ve();const Ye=q(We);function Ze(n){const[e,r]=t.useState(!1),{t:i}=h(),s=async()=>{try{r(!0),await le(n.horizonURL,n.publicKey)}catch(o){r(!1),ue(o)}};return t.createElement(ee,{Icon:e?se:Ye,className:n.className,description:i("account.transactions.action.friendbot.description"),label:i("account.transactions.action.friendbot.label"),onClick:s,style:n.style})}var E={},_,j;function Ge(){if(j)return _;j=1;var n=Ae();_=e;function e(r){r instanceof Date&&(r=Math.round((Date.now()-r)/1e3));var i=r<0?"from now":"ago";r=Math.abs(r);for(var s=[r/60/60/24/365,r/60/60/24/30,r/60/60/24/7,r/60/60/24,r/60/60,r/60,r],o=["year","month","week","day","hour","minute","second"],c=0;c<o.length;c++){var a=Math.floor(s[c]);if(a>1)return n.format("%d %ss %s",a,o[c],i);if(a===1)return n.format("%d %s %s",a,o[c],i)}return n.format("0 seconds %s",i)}return _}var V;function Je(){if(V)return E;V=1;var n=E&&E.__extends||function(){var s=function(o,c){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,u){a.__proto__=u}||function(a,u){for(var l in u)u.hasOwnProperty(l)&&(a[l]=u[l])},s(o,c)};return function(o,c){s(o,c);function a(){this.constructor=o}o.prototype=c===null?Object.create(c):(a.prototype=c.prototype,new a)}}();Object.defineProperty(E,"__esModule",{value:!0});var e=R(),r=Ge(),i=function(s){n(o,s);function o(c){var a=s.call(this,c)||this;return a.state=a.getStateFromProps(c),a}return o.prototype.getStateFromProps=function(c){return{formattedTime:r(new Date(c.time)).replace(/minute/,"min").replace(/^.*second.*$/,"now")}},o.prototype.componentDidMount=function(){var c=this;this._timer=setInterval(function(){return c.setState(c.getStateFromProps(c.props))},this.props.period||3e4)},o.prototype.componentWillUnmount=function(){clearInterval(this._timer)},o.prototype.render=function(){return this.state.formattedTime},o}(e.Component);return E.default=i,E}var Qe=Je();const Xe=q(Qe),et=n=>Array.from(new Set(n)),tt=()=>{};function nt(...n){return n.reduce((e,r)=>e.add(r),f(0))}function at(n){return n.animate?t.createElement(pe,{appear:!0,enter:!1,in:!0,timeout:{enter:1e3}},n.children):t.createElement(t.Fragment,null,n.children)}function M(n){const{amount:e,buying:r,offerId:i,price:s,selling:o}=n,{t:c}=h();let a;return i==="0"?a=`${c("account.transactions.transaction-list.offer-description.prefix.default")}: `:e.eq(0)?a=`${c("account.transactions.transaction-list.offer-description.prefix.cancel")}: `:a=`${c("account.transactions.transaction-list.offer-description.prefix.update")}: `,t.createElement(t.Fragment,null,a,n.type==="manageBuyOffer"?c("account.transactions.transaction-list.offer-description.buy",`Buy ${e.eq(0)?"":d(e.toString())} ${r.code} for ${e.eq(0)?"":d(e.mul(s).toString())} ${o.code}`,{buyingAmount:e.eq(0)?"":d(e.toString()),buyingCode:r.code,sellingAmount:e.eq(0)?"":d(e.mul(s).toString()),sellingCode:o.code}):c("account.transactions.transaction-list.offer-description.sell",`Sell ${e.eq(0)?"":d(e.toString())} ${o.code} for ${e.eq(0)?"":d(e.mul(s).toString())} ${r.code}`,{buyingAmount:e.eq(0)?"":d(e.mul(s).toString()),buyingCode:r.code,sellingAmount:e.eq(0)?"":d(e.toString()),sellingCode:o.code}))}function W(n){const{t:e}=h();return n.publicKeys.length===0?t.createElement(t.Fragment,null,"-"):n.publicKeys.length===1?t.createElement(g,{publicKey:n.publicKeys[0],testnet:n.testnet,variant:n.short?"short":"full"}):t.createElement(t.Fragment,null,t.createElement(g,{publicKey:n.publicKeys[0],testnet:n.testnet,variant:"short"})," ",t.createElement("i",null,"+ ",n.publicKeys.length-1," ",e("account.transactions.transaction-list.item.remote-public-keys.more")))}const rt=t.memo(function(e){const r=new Date(e.time);return t.createElement("span",{style:{whiteSpace:"nowrap"}},t.createElement(Xe,{time:r.getTime()}))});function ct(n){return n.transaction.operations.length===1&&["manageBuyOffer","manageSellOffer"].includes(n.transaction.operations[0].type)?t.createElement(z,null):n.transaction.operations.length===1&&n.transaction.operations[0].type==="changeTrust"?f(n.transaction.operations[0].limit).eq(0)?t.createElement(Fe,null):t.createElement(ye,null):n.transaction.operations.every(e=>e.type==="accountMerge")?t.createElement(H,null):n.paymentSummary.length===0?t.createElement(xe,null):n.paymentSummary.every(e=>e.balanceChange.gt(0))?t.createElement(H,null):n.paymentSummary.every(e=>e.balanceChange.lt(0))?t.createElement(De,null):t.createElement(z,null)}const it=t.memo(function(e){const r=Re(),{t:i}=h(),s=e.paymentSummary.reduce((a,u)=>a.concat(u.publicKeys),[]),o=e.transaction.networkPassphrase===de.Networks.TESTNET,c=t.useMemo(()=>t.createElement("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis"}},t.createElement(rt,{time:e.createdAt}),e.showMemo&&e.transaction.memo.type!=="none"?t.createElement(t.Fragment,null,"  |  ",t.createElement(qe,{prefix:t.createElement(t.Fragment,null,i("account.transactions.transaction-list.item.memo"),": "),memo:e.transaction.memo})):null),[e.createdAt,e.showMemo,e.transaction,i]);if(s.length>0&&e.paymentSummary.every(a=>a.balanceChange.gt(0)))return t.createElement(y,{primary:t.createElement("span",null,i("account.transactions.transaction-list.item.from")," ",t.createElement(W,{publicKeys:s,short:!0,testnet:o})),primaryTypographyProps:{style:e.style},secondary:c,style:e.style});if(s.length>0&&e.paymentSummary.every(a=>a.balanceChange.lt(0)))return t.createElement(y,{primary:t.createElement("span",null,i("account.transactions.transaction-list.item.to")," ",t.createElement(W,{publicKeys:s,short:!0,testnet:o}),e.alwaysShowSource?t.createElement("span",null," ",i("account.transactions.transaction-list.item.from")," ",t.createElement(g,{publicKey:e.accountPublicKey,testnet:o,variant:"short"})," "):null),primaryTypographyProps:{style:e.style},secondary:c,style:e.style});if(e.transaction.operations.length===1&&e.transaction.operations[0].type==="changeTrust"){const a=e.transaction.operations[0];return f(a.limit).eq(0)?t.createElement(y,{primary:t.createElement("span",null,i("account.transactions.transaction-list.item.trust.remove-trust",`Remove trust in asset ${x(a.line)}`,{asset:x(a.line)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(g,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:c,style:e.style}):t.createElement(y,{primary:t.createElement("span",null,i("account.transactions.transaction-list.item.trust.add-trust",`Trust asset ${x(a.line)}`,{asset:x(a.line)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(g,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:c,style:e.style})}else if(e.transaction.operations.length===1&&["manageBuyOffer","manageSellOffer"].includes(e.transaction.operations[0].type)){const a=e.transaction.operations[0],u=f(a.type==="manageBuyOffer"?a.buyAmount:a.amount);return String(a.offerId)==="0"?t.createElement(y,{primary:t.createElement("span",null,t.createElement(M,{...a,amount:u,price:f(a.price)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(g,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:c,style:e.style}):u.eq(0)?t.createElement(y,{primary:t.createElement("span",null,t.createElement(M,{...a,amount:f(0),price:f(a.price)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(g,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:c,style:e.style}):t.createElement(y,{primary:t.createElement("span",null,t.createElement(M,{...a,amount:u,price:f(a.price)}),e.alwaysShowSource?t.createElement(t.Fragment,null," ","(",t.createElement(g,{publicKey:e.accountPublicKey,testnet:o,variant:"short"}),")"):null),primaryTypographyProps:{style:e.style},secondary:c,style:e.style})}else{const a=e.transaction.operations.map(r);return t.createElement(y,{primary:t.createElement("span",null,et(a).join(", ")),primaryTypographyProps:{style:e.style},secondary:c,style:e.style})}});function ot(n){const{paymentSummary:e}=n,r=I(),i=n.transaction.operations.filter(c=>c.type==="createAccount"),s=n.transaction.operations.filter(c=>c.type==="payment"),o=e.every(c=>c.publicKeys.every(a=>a===n.accountPublicKey))?nt(...i.map(c=>c.startingBalance),...s.map(c=>c.amount)):e[0].balanceChange;return t.createElement(y,{primaryTypographyProps:{align:"right"},style:{flexShrink:0,...n.style}},e.length===0?null:t.createElement(Ie,{assetCode:e[0].asset.getCode(),balance:o.toString(),style:r?{fontSize:"1rem"}:{fontSize:"1.4rem"}}))}const te=t.memo(function(e){const{hideMemos:r}=t.useContext(P),i=I(),{transaction:s,onOpenTransaction:o}=e,c=we(e.accountPublicKey,s),a=o?()=>o(s.hash().toString("hex")):void 0;return t.createElement(Q,{button:!!a,className:e.className||"",onClick:a,style:e.style},t.createElement(Ce,{style:{marginRight:i?0:void 0}},e.icon||t.createElement(ct,{paymentSummary:c,transaction:s})),t.createElement(it,{accountPublicKey:e.accountPublicKey,alwaysShowSource:e.alwaysShowSource,createdAt:e.createdAt,paymentSummary:c,showMemo:!r,style:{fontSize:i?"0.8rem":void 0,fontWeight:"bold",overflow:"hidden",paddingRight:0,textOverflow:"ellipsis"},transaction:s}),t.createElement(ot,{accountPublicKey:e.accountPublicKey,paymentSummary:c,style:{paddingRight:0},transaction:s}))}),st=t.memo(function(e){const{t:r}=h();return t.createElement(Q,{style:{borderBottom:"none",height:75}},t.createElement(y,{disableTypography:!0,style:{textAlign:"center"}},t.createElement(me,{onClick:e.onClick,loading:e.pending,style:{margin:"0 auto",paddingLeft:16,paddingRight:16},variant:"text"},r("account.transactions.transaction-list.load-more.label"))))}),lt=Z({listItem:{padding:"8px 24px",[J.down(600)]:{paddingLeft:24,paddingRight:24}}});function ut(n){const e=lt(),r=I(),i=w(),s=A(i.location.pathname,p("*","*"))?i.match.params.subaction:null,o=t.useMemo(()=>{if(!s)return null;const l=n.transactions.find(b=>b.hash===s),m=l?l.decodedTx:null;return m&&l?Object.assign(m,{created_at:l.created_at}):m},[s,n.transactions]),c=t.useCallback(l=>{i.history.push(p(n.account.id,l))},[n.account.id,i.history]),a=t.useCallback(()=>{i.history.push(Te(n.account.id)),setTimeout(()=>{document.activeElement&&document.activeElement.blur()},0)},[n.account.id,i.history]),u=t.useMemo(()=>t.createElement(t.Fragment,null,n.transactions.map(l=>t.createElement(at,{key:l.hash,animate:Date.now()-new Date(l.created_at).getTime()<1e4},t.createElement(G,{height:72},t.createElement(te,{key:l.hash,accountPublicKey:n.account.publicKey,className:e.listItem,createdAt:l.created_at,onOpenTransaction:c,transaction:l.decodedTx}))))),[n.transactions,n.account.publicKey,e.listItem,c]);return n.transactions.length===0&&!n.olderTransactionsAvailable?null:t.createElement(k,{disablePadding:r,style:{background:n.background}},t.createElement(D,{className:e.listItem,disableSticky:!0,style:{background:n.background}},n.title),u,n.olderTransactionsAvailable?t.createElement(st,{pending:n.loadingMoreTransactions,onClick:n.onFetchMoreTransactions}):null,t.createElement(Se,{open:o!==null,account:n.account,disabled:!0,showSource:!0,showSubmissionProgress:!1,transaction:o,onClose:a,onSubmitTransaction:tt}))}const mt=t.memo(ut);function yt(n){const{onOpenTransaction:e,signatureRequest:r}=n,i=t.useMemo(()=>new X(r.req).getTransaction(),[r.req]),s=t.useCallback(e?()=>e(i,r):()=>{},[e,r,i]);return t.createElement(te,{alwaysShowSource:!0,accountPublicKey:i.source,createdAt:r.created_at,icon:n.icon,onOpenTransaction:s,style:n.style,transaction:i})}const dt=t.memo(function(e){const{sendTransaction:r}=e,i=w();t.useEffect(()=>{const o=a=>{if(A(a,p("*","*"))){const[,,,u]=a.replace(/^\//,"").split("/"),l=e.signatureRequests.find(m=>m.hash===u);if(l){const m=new X(l.req);r(m.getTransaction(),l)}}};return o(i.location.pathname),i.history.listen(a=>{o(a.pathname)})},[i.history,i.location.pathname,r,e.signatureRequests]);const s=(o,c)=>{i.history.push(p(e.account.id,c.hash))};return e.signatureRequests.length===0?null:t.createElement(t.Fragment,null,t.createElement(k,{style:{background:"transparent"}},t.createElement(D,{disableSticky:!0,style:{background:"transparent"}},e.title),e.signatureRequests.map(o=>t.createElement(G,{height:72,key:o.hash},t.createElement(yt,{icon:e.icon,onOpenTransaction:s,signatureRequest:o,style:{minHeight:72}})))))}),Y=t.memo(n=>{const e=w(),r=!A(e.location.pathname,p("*","*")),i=t.useCallback(()=>{e.history.push(Ke(e.location.pathname))},[e]);return t.createElement(_e,{account:n.account,forceClose:r,onCloseTransactionDialog:i},({sendTransaction:s})=>t.createElement(dt,{account:n.account,icon:n.icon,sendTransaction:s,signatureRequests:n.signatureRequests,title:n.title}))}),ft=Z({list:{paddingBottom:0},header:{padding:"8px 24px 0px 24px",lineHeight:1,alignItems:"center",display:"flex",cursor:"pointer",[J.down(600)]:{paddingLeft:24,paddingRight:24}}});function gt(n){const e=ft(),r=w(),i=fe(n.account.accountID,n.account.testnet),{t:s}=h(),o=()=>{r.history.push(Pe(n.account.id))};return i.offers.length?t.createElement(k,{className:e.list},t.createElement(D,{className:e.header,disableSticky:!0,onClick:o},s("account.transactions.offer-list.title")," (",i.offers.length,i.olderOffersAvailable?"+":"",") ",t.createElement(Me,null))):null}const ht=(n,e)=>!e.decodedTx.operations.every(r=>r.type==="createClaimableBalance"||r.type==="claimClaimableBalance"&&r.source!==n.publicKey),bt=(n,e)=>!Oe(e.decodedTx,n);function Et(n){const{pendingSignatureRequests:e}=t.useContext(ve),{t:r}=h(),i=t.useMemo(()=>t.createElement(ze,null),[]),s=t.useMemo(()=>t.createElement(ke,{style:{opacity:.5}}),[]),o=t.useMemo(()=>e.filter(a=>a.status!=="submitted"&&a.signers.some(u=>u===n.account.publicKey)&&a.signed_by.indexOf(n.account.publicKey)===-1),[n.account,e]),c=t.useMemo(()=>e.filter(a=>a.status!=="submitted"&&a.signers.some(u=>u===n.account.publicKey)&&a.signed_by.indexOf(n.account.publicKey)>-1),[n.account,e]);return t.createElement(t.Fragment,null,t.createElement(Y,{account:n.account,icon:i,signatureRequests:o,title:r("account.transactions.signature-request-list.title.requests-to-cosign")}),t.createElement(Y,{account:n.account,icon:s,signatureRequests:c,title:r("account.transactions.signature-request-list.title.requests-waiting-for-others")}))}function vt(n){const{account:e}=n,{showDust:r,showClaimableBalanceTxs:i}=t.useContext(P),{t:s}=h(),o=ge(e.accountID,e.testnet),c=he(e.testnet),a=I(),[u,l]=be(),m=t.useCallback(ce=>ce.filter(B=>(i||ht(e,B))&&(r||bt(e,B))),[]),{transactions:b,olderTransactionsAvailable:K,fetchMoreTransactions:C}=je(e.accountID,e.testnet,m),F=w(),ne=t.useContext(P),ae=t.useCallback(()=>l(C()),[C,l]),re=t.useCallback(()=>F.history.push(Le(e.id)),[e,F]);return t.createElement(t.Fragment,null,o.balances.length>0?t.createElement(t.Fragment,null,ne.multiSignature?t.createElement(Et,{account:e}):null,t.createElement(gt,{account:e}),t.createElement(mt,{account:e,background:"transparent",loadingMoreTransactions:u.type==="pending",olderTransactionsAvailable:K,onFetchMoreTransactions:ae,title:s("account.transactions.transaction-list.title"),transactions:b})):t.createElement(t.Fragment,null,t.createElement(Ee,{alignItems:"stretch",margin:"0 auto",style:{padding:a?"16px 28px":"32px 28px",width:"fit-content"}},e.testnet?t.createElement(Ze,{horizonURL:c[0],publicKey:e.publicKey,style:{marginBottom:a?16:32}}):null,t.createElement(ee,{Icon:Ne,description:s("account.transactions.action.navigate-to-deposit.description"),label:s("account.transactions.action.navigate-to-deposit.label"),onClick:re}))))}const qt=t.memo(vt);export{qt as default};
//# sourceMappingURL=AccountTransactions-BrfQfx5u.js.map
